function setupConfig(e){var t=gbst.namespace("gbst.loan.app.extrarepaymentscalculator.translations");t.en=e}(function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/amortization-table"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='\n			<tr>\n				<th headers="amortization-table-column1" class="payment-period">',(i=n.period)?i=i.call(e,{hash:{},data:t}):(i=e.period,i=typeof i===a?i.apply(e):i),r+=f(i)+'</th>\n				<td headers="amortization-table-column2">',(i=n.principalRemaining)?i=i.call(e,{hash:{},data:t}):(i=e.principalRemaining,i=typeof i===a?i.apply(e):i),r+=f(i)+'</td>\n				<td headers="amortization-table-column3">',(i=n.interestRemaining)?i=i.call(e,{hash:{},data:t}):(i=e.interestRemaining,i=typeof i===a?i.apply(e):i),r+=f(i)+'</td>\n				<td headers="amortization-table-column4">',(i=n.totalRemaining)?i=i.call(e,{hash:{},data:t}):(i=e.totalRemaining,i=typeof i===a?i.apply(e):i),r+=f(i)+"</td>\n			</tr>	\n			",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+='<div class="amortization-content-panel">\n	<table id="gbst-amortization-table" class="amortization-table" summary="A table detailing each periodic payment on an amortizing loan">\n		<thead>\n			<tr>\n				<th class="payment-period">',(o=n.paymentPeriodHeader)?o=o.call(t,{hash:{},data:i}):(o=t.paymentPeriodHeader,o=typeof o===a?o.apply(t):o),s+=f(o)+"</th>\n				<th>",(o=n.principalHeader)?o=o.call(t,{hash:{},data:i}):(o=t.principalHeader,o=typeof o===a?o.apply(t):o),s+=f(o)+"</th>\n				<th>",(o=n.interestHeader)?o=o.call(t,{hash:{},data:i}):(o=t.interestHeader,o=typeof o===a?o.apply(t):o),s+=f(o)+"</th>\n				<th>",(o=n.balanceHeader)?o=o.call(t,{hash:{},data:i}):(o=t.balanceHeader,o=typeof o===a?o.apply(t):o),s+=f(o)+"</th>\n			</tr>\n		</thead>\n		<tbody>\n			",u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.tableData)?o=o.call(t,u):(o=t.tableData,o=typeof o===a?o.apply(t):o),n.tableData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='		\n		</tbody>\n	</table>\n\n	<button type="button" class="back">Back</button>\n	<button type="button" class="next">Next</button>\n\n</div>\n',s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/amortization-table"]}).call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/app-template"]=Handlebars.template(function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n			<span class="calculator-disclaimer">',(i=n.disclaimer)?i=i.call(e,{hash:{},data:t}):(i=e.disclaimer,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+="</span>\n			",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this;s+='<div class="gbst-loan-repayment">\n\n		<div class="title">\n			<h1>',(o=n.calculatorTitle)?o=o.call(t,{hash:{},data:i}):(o=t.calculatorTitle,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</h1>\n			\n			<div class="info-panel">\n				<div class="button-wrapper"> \n					<button type="button" class="button info-icon" title="Information"></button>\n			</div>\n			\n				<div class="button-wrapper print"> \n					<button type="button" class="button print-icon" title="Print"></button>\n			</div>\n			</div>\n			\n			<div class="gbst-clear"></div>\n		</div>\n                \n                <div class="content">\n			<div class="inputs-wrapper"></div>\n			\n			<div class="results-line">\n				<h3 class="results-title">',(o=n.resultsHeader)?o=o.call(t,{hash:{},data:i}):(o=t.resultsHeader,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</h3>\n			</div>\n\n			<div class="results-wrapper">\n				<div class="displayType"></div>\n				<div class="chart-wrapper"></div>\n				<div class="amortization-table-wrapper"></div>\n				<div class="outputs-wrapper" role="region" aria-live="polite"></div>\n				<div class="gbst-clear"></div>\n			</div>\n				\n			<div class="gbst-clear"></div>\n			',o=n["if"].call(t,t.disclaimer,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+="\n		</div>\n	</div>\n",s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/app-template"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/chart-tooltip"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i,s,o;r+='\n\n		<div class="line"></div>\n\n		<div class="principal-remaining">\n		<div class="symbol principal"></div>\n		<span class="summary-label">',o={hash:{},data:t},s=(i=n.I18n,i?i.call(e,"labels.chartView.balanceAfterExtraRepaymentsTitle",o):f.call(e,"I18n","labels.chartView.balanceAfterExtraRepaymentsTitle",o));if(s||s===0)r+=s;return r+='</span>\n		<span class="summary-value">',o={hash:{precision:0},data:t},r+=l((i=n["I18n-$"],i?i.call(e,e.balanceAfterExtraRepayments,o):f.call(e,"I18n-$",e.balanceAfterExtraRepayments,o)))+'</span>\n		<div class="gbst-clear"></div>\n	</div>\n		\n	',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;s+='<div class="arrow left"></div>\n\n<div class="chart-tooltip">\n	<div class="tooltip-title">',a={hash:{year:t.year},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.chartTooltip.title",a):f.call(t,"I18n","labels.chartTooltip.title",a)))+'</div>\n		\n	<div class="total-remaining">\n		<div class="symbol total"></div>\n		<span class="summary-label">',a={hash:{},data:i},u=(o=n.I18n,o?o.call(t,"labels.chartView.originalBalanceTitle",a):f.call(t,"I18n","labels.chartView.originalBalanceTitle",a));if(u||u===0)s+=u;s+='</span>\n		<span class="summary-value">',a={hash:{precision:0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.originalBalance,a):f.call(t,"I18n-$",t.originalBalance,a)))+'</span>\n		<div class="gbst-clear"></div>\n	</div>\n	\n	',a={hash:{},inverse:c.noop,fn:c.program(1,h,i),data:i},u=(o=n.notUndefined,o?o.call(t,t.balanceAfterExtraRepayments,a):f.call(t,"notUndefined",t.balanceAfterExtraRepayments,a));if(u||u===0)s+=u;return s+='\n</div>\n\n<div class="arrow right"></div>\n',s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/chart-tooltip"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/information-overlay-tmpl"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression;s+='<div id="information-overlay" class="modal-overlay">\n		<div class="wrapper">\n			<button type="button" class="close"></button>\n			<h2>',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.infoBox.title",a):f.call(t,"I18n","labels.infoBox.title",a)))+"</h2>\n			",a={hash:{},data:i},u=(o=n.I18n,o?o.call(t,"labels.infoBox.content",a):f.call(t,"I18n","labels.infoBox.content",a));if(u||u===0)s+=u;return s+="\n		</div>\n	</div>\n",s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/information-overlay-tmpl"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/loan-chart"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="loan-chart"></div>\n'}),this.HandlebarsTemplates["extra-repayment-calculator/templates/loan-chart"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/outputs-wrapper"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c="function";s+='<div>\n	<div class="results-responsive">\n		<div class="results-arrow"></div>\n		<div class="results-box frequency-result">\n			<div class="result-content">\n				<div id="timeSaved" tabindex="0" class="no-margin">\n					<span class="label">',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.resultsView.timeSaved",a):f.call(t,"I18n","labels.resultsView.timeSaved",a)))+'</span>\n					<div class="gbst-clear"></div>\n					<div class="timesaved">\n						<span class="value years">'+l((o=(o=t.totalTimeSaved,o==null||o===!1?o:o.years),typeof o===c?o.apply(t):o))+'</span>\n						<span class="label years">',a={hash:{count:(o=t.totalTimeSaved,o==null||o===!1?o:o.years)},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.resultsView.yearsFormat",a):f.call(t,"I18n","labels.resultsView.yearsFormat",a)))+'</span>\n\n						<span class="value months">'+l((o=(o=t.totalTimeSaved,o==null||o===!1?o:o.months),typeof o===c?o.apply(t):o))+'</span>\n						<span class="label months">',a={hash:{count:(o=t.totalTimeSaved,o==null||o===!1?o:o.months)},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.resultsView.monthsFormat",a):f.call(t,"I18n","labels.resultsView.monthsFormat",a)))+'</span>\n\n						<div class="gbst-clear"></div>\n					</div>\n				</div>\n				<div id="repayment" tabindex="0" class="additional-margin">    \n					<span class="label">',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.resultsView.interestSaved",a):f.call(t,"I18n","labels.resultsView.interestSaved",a)))+'</span>\n					<div class="gbst-clear"></div>\n					<span class="value">',a={hash:{precision:0,html:!0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.interestSaved,a):f.call(t,"I18n-$",t.interestSaved,a)))+'</span>\n				</div>\n			</div>\n		</div>\n		\n		<div class="results-box total-result">\n			<div class="result-content">\n				<div id="repayment" tabindex="0">    \n					<span class="label small">',(u=n.minRepaymentLabel)?u=u.call(t,{hash:{},data:i}):(u=t.minRepaymentLabel,u=typeof u===c?u.apply(t):u);if(u||u===0)s+=u;s+='</span>\n					<div class="gbst-clear"></div>\n					<span class="value small">',a={hash:{precision:0,html:!0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.minRepayments,a):f.call(t,"I18n-$",t.minRepayments,a)))+'</span>\n				</div>    \n				<div id="repayment" tabindex="0" class="additional-margin">    \n					<span class="label small">',(u=n.incRepaymentLabel)?u=u.call(t,{hash:{},data:i}):(u=t.incRepaymentLabel,u=typeof u===c?u.apply(t):u);if(u||u===0)s+=u;return s+='</span>\n					<div class="gbst-clear"></div>\n					<span class="value small">',a={hash:{precision:0,html:!0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.incRepayments,a):f.call(t,"I18n-$",t.incRepayments,a)))+"</span>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n",s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/outputs-wrapper"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/style"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+="\n	.extra-repayments-calculator-app .inputs-wrapper h2 {\n		background-color: ",(i=n.subtitleBgColor)?i=i.call(e,{hash:{},data:t}):(i=e.subtitleBgColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		color: ",(i=n.subtitleColor)?i=i.call(e,{hash:{},data:t}):(i=e.subtitleColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.extra-repayments-calculator-app .number-wrapper, .extra-repayments-calculator-app .results-line .results-title {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		color: ",(i=n.titleColor)?i=i.call(e,{hash:{},data:t}):(i=e.titleColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important; \n	}\n	.extra-repayments-calculator-app .info-panel .info-icon, .extra-repayments-calculator-app .info-panel .print-icon {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.extra-repayments-calculator-app .slider-wrapper .progress {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.extra-repayments-calculator-app .info-panel .info-icon:hover, .extra-repayments-calculator-app .info-panel .print-icon:hover {\n		background-color: ",(i=n.hoverColor)?i=i.call(e,{hash:{},data:t}):(i=e.hoverColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important; \n	}\n	.extra-repayments-calculator-app h1, .extra-repayments-calculator-app .standard-label, .extra-repayments-calculator-app input.range,\n	.extra-repayments-calculator-app .radio-buttons-label, .extra-repayments-calculator-app .slider-label,\n	.extra-repayments-calculator-app .results-box span, .extra-repayments-calculator-app .modal-overlay, .extra-repayments-calculator-app .currentTaxThresholds,\n	.extra-repayments-calculator-app span.ui-selectmenu-status, .extra-repayments-calculator-app .checkbox-label span,\n	.extra-repayments-calculator-app .amortization-table-wrapper, .extra-repayments-calculator-app .chart-tooltip {\n		color: ",(i=n.textColor)?i=i.call(e,{hash:{},data:t}):(i=e.textColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.extra-repayments-calculator-app .displayType label {\n		color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		background-color: ",(i=n.transparentColor)?i=i.call(e,{hash:{},data:t}):(i=e.transparentColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		border-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+";\n	}\n	.extra-repayments-calculator-app .displayType label.ui-state-active {\n		color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		background-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		border-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+";\n	}\n	.extra-repayments-calculator-app .displayType label:hover {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	} \n	.extra-repayments-calculator-app .displayType label.ui-state-active:hover {\n		cursor: default !important;\n		background: none !important;\n		filter: none !important;\n		background-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.extra-repayments-calculator-app .chart-tooltip .symbol.total {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	}\n	.extra-repayments-calculator-app .chart-tooltip .symbol.principal {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	}\n	.extra-repayments-calculator-app .amortization-content-panel button {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	} \n	",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+="<style>\n	",u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.colors)?o=o.call(t,u):(o=t.colors,o=typeof o===a?o.apply(t):o),n.colors||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</style>\n",s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/style"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["extra-repayment-calculator/templates/your-income-details"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression;s+='<div>\n	<div class="section">\n		<h2>\n			<span class="number-wrapper">1</span>\n			<span class="title-wrapper">',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.loanControlsView.controlsTitle",a):f.call(t,"I18n","labels.loanControlsView.controlsTitle",a)))+'</span>\n		</h2>  \n\n		<div class="expandable">\n			<ul class="controls-wrapper">\n				<li class="principal slider-wrapper"></li>\n				<li class="frequency select-wrapper"></li>\n				<li class="interestRate slider-wrapper"></li>\n				<li class="term slider-wrapper"></li>\n				<div class="gbst-clear"></div>\n			</ul>\n		</div>\n	</div>	\n\n	<div class="section loan-details-section">\n		<h2>\n			<span class="number-wrapper">2</span>\n			<span class="title-wrapper">',a={hash:{},data:i},u=(o=n.I18n,o?o.call(t,"labels.loanControlsView.extraContributionTitle",a):f.call(t,"I18n","labels.loanControlsView.extraContributionTitle",a));if(u||u===0)s+=u;return s+='</span>\n		</h2>  \n		<div class="expandable">\n			<ul class="controls-wrapper additional-margin">\n				<li class="extraContribution slider-wrapper"></li>\n				<li class="extraContributionStartYear slider-wrapper no-right-margin"></li>\n				<div class="gbst-clear"></div>\n			</ul>\n		</div>\n	</div>	\n</div>\n',s}),this.HandlebarsTemplates["extra-repayment-calculator/templates/your-income-details"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["slider-input/templates/slider-input-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<label class="slider-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</label><input id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i),r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='" name="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'" type="range" required="true"></input>\n<div class="gbst-clear"></div>\n',s}),this.HandlebarsTemplates["slider-input/templates/slider-input-templates"]}.call(this),function(){Handlebars.registerPartial("selectmenu/templates/_select-control",Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<select id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" name="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="standard-input ',(i=n.controlClass)?i=i.call(e,{hash:{},data:t}):(i=e.controlClass,i=typeof i===a?i.apply(e):i),r+=f(i),r}function p(e,t){var r="",i,s;r+="\n		",s={hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t},(i=n.listData)?i=i.call(e,s):(i=e.listData,i=typeof i===a?i.apply(e):i),n.listData||(i=c.call(e,i,s));if(i||i===0)r+=i;return r+="\n	",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+"</option>\n		",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+='">\n	',u={hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i},(o=n.controlData)?o=o.call(t,u):(o=t.controlData,o=typeof o===a?o.apply(t):o),n.controlData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</select>\n",s}))}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["selectmenu/templates/selectmenu-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<label class="standard-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.titleString)?i=i.call(e,{hash:{},data:t}):(i=e.titleString,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,r=r||e.partials,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+="\n",o=l.invokePartial(r["selectmenu/templates/_select-control"],"selectmenu/templates/_select-control",t,n,r,i);if(o||o===0)s+=o;return s+='\n\n<div class="gbst-clear"></div>\n\n\n',s}),this.HandlebarsTemplates["selectmenu/templates/selectmenu-templates"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["standard-input/templates/standard-input-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='\n<label class="standard-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</label>\n<input id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i),r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='" name="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'" maxlength="'+f((o=(o=(o=t.controlData,o==null||o===!1?o:o.inputData),o==null||o===!1?o:o.maxlength),typeof o===a?o.apply(t):o))+'" class="range standard-input" type="text"></input>\n<div class="gbst-clear"></div>\n',s}),this.HandlebarsTemplates["standard-input/templates/standard-input-templates"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["radiogroup-input/templates/radiogroup-input"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i,s;r+='\n	\n	<p class="radiogroup-label">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</p>\n\n	<fieldset id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">\n		<legend>',(i=n.legend)?i=i.call(e,{hash:{},data:t}):(i=e.legend,i=typeof i===a?i.apply(e):i),r+=f(i)+"</legend>\n		",s={hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t},(i=n.radiosData)?i=i.call(e,s):(i=e.radiosData,i=typeof i===a?i.apply(e):i),n.radiosData||(i=c.call(e,i,s));if(i||i===0)r+=i;return r+="\n	</fieldset>\n	\n	",r}function p(e,t){var r="",i;return r+='\n			<input type="radio" id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" name="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===a?i.apply(e):i),r+=f(i)+'" value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'"/>\n			<label for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="',(i=n.clazz)?i=i.call(e,{hash:{},data:t}):(i=e.clazz,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>\n		",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+='<div class="radio">\n	',u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</div>\n",s}),this.HandlebarsTemplates["radiogroup-input/templates/radiogroup-input"]}.call(this),function(e){Handlebars.registerHelper("I18n",function(e,t){var n=t;t&&t.hash&&(n=t.hash);var r="";return I18n?e!=null?r=I18n.t(e,n):r="Invalid 'str' value":r=e,r}),Handlebars.registerHelper("I18n-$",function(t,n){var r=n;n&&n.hash&&(r=n.hash);if(r.html){var i=I18n.t("number.currency.format.htmlFormat");e.extend(r,{format:i})}var s="";return I18n?t!=null?s=I18n.toCurrency(t,r):s="Invalid 'str' value":s=t,new Handlebars.SafeString(s)}),Handlebars.registerHelper("notUndefined",function(e,t){return typeof e=="undefined"?t.inverse(this):t.fn(this)})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config.chart");t.getChartConfig=function(t,n){var r={color:I18n.t("colors.textColor"),fontWeight:"bold",fontSize:"11px",fontFamily:"Arial, Verdana"},i={color:I18n.t("colors.textColor"),fontWeight:"bold",fontSize:"13px",fontFamily:"Arial, Verdana"},s={parentId:"loan-chart",chart:{backgroundColor:"rgba(255,255,255,0.5)",defaultSeriesType:"area",plotShadow:!1,reflow:!1,marginTop:40,spacingTop:0,spacingBottom:0,spacingRight:20,spacingLeft:10,borderRadius:0,renderTo:t,events:{load:n}},colors:["#0782be","#005c88"],credits:{enabled:!1},legend:{layout:"horizontal",backgroundColor:"rgba(255,255,255,0.33)",align:"right",verticalAlign:"top",x:0,y:5,floating:!0,borderRadius:5,borderWidth:0,itemStyle:{color:I18n.t("colors.textColor"),cursor:"default",fontWeight:"normal",fontSize:"12px",fontFamily:"Arial, Verdana"},itemHoverStyle:{color:I18n.t("colors.textColor")}},xAxis:{endOnTick:!0,labels:{style:r,y:20},lineColor:"#e1e1e1",lineWidth:1,maxPadding:0,min:0,title:{align:"middle",style:i,margin:20},tickColor:"#666666",tickPlacement:"on",tickPosition:"outside",tickWidth:2,tickLength:3},yAxis:{gridLineColor:"#e1e1e1",gridLineWidth:1,allowDecimals:!1,labels:{style:r},lineColor:"#e1e1e1",lineWidth:1,min:0,title:{style:i},tickColor:"#666666",tickPlacement:"on",tickPosition:"outside",tickWidth:2,tickLength:3},plotOptions:{series:{animation:!0,enableMouseTracking:!1,pointPadding:0,groupPadding:0,events:{legendItemClick:function(){return!1}}},area:{lineWidth:0,fillOpacity:1,connectNulls:!0,marker:{radius:0,lineWidth:0}}},title:{text:null}},o={title:{},xAxis:{title:{text:I18n.t("labels.chartView.xAxisTitle")}},yAxis:{title:{text:I18n.t("labels.chartView.yAxisTitle",{unit:I18n.t("number.currency.format.unit")})}},series:this.getChartSeries(),tooltip:{enabled:!1}};return e.extend(!0,s,o),s},t.getChartSeries=function(){return[{id:"principalRemaining",name:I18n.t("labels.chartView.originalBalanceTitle"),borderWidth:0,color:{linearGradient:[0,0,200,0],stops:[[0,hexToRGBA(lighterColor(I18n.t("colors.secondaryColor"),.1),"1")],[1,hexToRGBA(darkerColor(I18n.t("colors.secondaryColor"),.1),"1")]]},shadow:!1},{id:"principalRemaining",name:I18n.t("labels.chartView.balanceAfterExtraRepaymentsTitle"),borderWidth:0,color:{linearGradient:[0,0,200,0],stops:[[0,hexToRGBA(lighterColor(I18n.t("colors.primaryColor"),.1),"1")],[1,hexToRGBA(darkerColor(I18n.t("colors.primaryColor"),.1),"1")]]},shadow:!1}]},t.tooltip={indicatorColor:"rgba(204, 204, 204, 0.3)",mouseOffsetX:5,mouseOffsetY:-30,touchOffsetX:0,touchOffsetY:-170}}(jQuery),function(e){var t=gbst.namespace("gbst.loan.app.extrarepaymentscalculator.translations");I18n.translations=I18n.translations||{},I18n.translations.en=t.en}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.model");n.ControlValues=Backbone.Model.extend({localStorage:null,defaults:I18n.t("defaults.values"),initialize:function(){window.localStorage&&(this.localStorage=new Store("gbst.loan.app.extrarepaymentscalculator"))},parse:function(t){return e.isArray(t)&&t.length>0&&(t=_.first(t)),t},getFrequency:function(){var e=this.get("frequency"),n=t.periods[e];if(!n)throw new Error("Missing frequency value for frequency type: '"+e+"'");return n},getDisplayType:function(){return this.get("displayType")},isDisplayTypeTable:function(){return this.getDisplayType()==t.displayType.TABLE}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.model"),r=gbst.module("gbst.loan.app.extrarepaymentscalculator.view"),i=gbst.module("gbst.loan.shared.view");n.ControlsDeclaration=function(){return{income:{id:"extra-repayment-calculator/templates/your-income-details",controls:[{name:"principal",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanControlsView.principal",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.principal")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"interestRate",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanControlsView.interestRate",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.interestRate")},formatter:t.convertFn.interestConverter_back,parser:t.convertFn.interestConverter},{name:"term",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanControlsView.term",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.term")},formatter:function(e){var t=I18n.t("labels.loanControlsView.termFormat",{count:e});return t},parser:t.convertFn.numberConverter},{name:"frequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates"
,templateData:{title:"labels.loanControlsView.frequency",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")},parser:t.convertFn.numberConverter},{name:"extraContribution",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanControlsView.extraContribution",controlId:gbst.util.getNewId(),labelClass:"",controlClass:""},controlData:{sliderData:I18n.t("defaults.controls.extraContribution")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"extraContributionStartYear",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanControlsView.extraContributionStartYear",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.extraContributionStartYear")},formatter:function(e){var t=I18n.t("labels.loanControlsView.termFormat",{count:e});return t},parser:t.convertFn.numberConverter}]}}},n.DisplayTypeDeclaration=function(){return{name:"displayType",view:i.RadiogroupView,templateId:"radiogroup-input/templates/radiogroup-input",templateData:{controlId:gbst.util.getNewId(),title:"",legend:"",radiosData:[{controlId:gbst.util.getNewId(),name:"chart-table",value:t.displayType.GRAPH,label:I18n.t("labels.resultsView.displayType.graph")},{controlId:gbst.util.getNewId(),name:"chart-table",value:t.displayType.TABLE,label:I18n.t("labels.resultsView.displayType.table")}]}}}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.model");t.LoanSummaryResult=function(){this.pmt=0,this.chartSummary=new t.ChartSummaryModel,this.interestEarned=0,this.nperRemaining=0,this.amortizationSummary=[]},t.ChartSummaryModel=function(){this.principalRemaining=[],this.tooltipData=[]}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.model");t.ResultsModel=Backbone.Model.extend({defaults:{amortizationSummary:[],originalLoanSummaryResult:null,extraRepaymentsSummaryResult:null,frequency:"",extraRepaymentStartTerm:-1,incRepayments:-1,interestSaved:-1,minRepayments:-1,totalTimeSaved:null},getRemainingPrincipal:function(e){var t=this.get("originalLoanSummaryResult").chartSummary,n=t.principalRemaining[e].y;return n}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.model");t.TableModel=Backbone.Model.extend({defaults:{currentIndex:0,maximumRowsPerPage:8,amortizationSummary:[]},getCurrentIndex:function(){return this.get("currentIndex")},setCurrentIndex:function(e){this.set("currentIndex",e)},getMaximumRowsPerPage:function(){return this.get("maximumRowsPerPage")},setMaximumRowsPerPage:function(e){this.set("maximumRowsPerPage",e)},getAmortizationSummary:function(){return this.get("amortizationSummary")},setAmortizationSummary:function(e){this.setCurrentIndex(0),this.set("amortizationSummary",e)},getCurrentSet:function(){var e=this.getCurrentIndex(),t=this.getMaximumRowsPerPage(),n=this.getAmortizationSummary(),r=[],i=0,s={precision:0};while(i<t&&e+i<n.length){var o=e+i,u=n[o],a={period:o,totalRemaining:I18n.toCurrency(u.totalRemaining,s),principalRemaining:I18n.toCurrency(u.principalRemaining,s),interestRemaining:I18n.toCurrency(u.interestRemaining,s)};r.push(a),i++}return r},getNextSet:function(){var e=this.getCurrentIndex(),t=this.getMaximumRowsPerPage(),n=e+t;this.setCurrentIndex(n)},getPreviousSet:function(){var e=this.getCurrentIndex(),t=this.getMaximumRowsPerPage(),n=e-t;n=n<0?0:n,this.setCurrentIndex(n)},isLastSet:function(){var e=this.getCurrentIndex(),t=this.getMaximumRowsPerPage(),n=this.getAmortizationSummary().length,r=e+t>n?!0:!1;return r},isFirstSet:function(){var e=this.getCurrentIndex(),t=e==0?!0:!1;return t}})}(jQuery);var pad=function(e,t){var n="0";e+="";while(e.length<t)e=n+e;return e},changeColor=function(e,t,n){e=e.replace(/^\s*|\s*$/,""),e=e.replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");var r=Math.round(t*256)*(n?-1:1),i=e.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),s=!i||i[4]==null?null:i[4],o=i?[i[1],i[2],i[3]]:e.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return parseInt(arguments[1],16)+","+parseInt(arguments[2],16)+","+parseInt(arguments[3],16)}).split(/,/),u;return i?"rgb"+(s!==null?"a":"")+"("+Math[n?"max":"min"](parseInt(o[0],10)+r,n?0:255)+", "+Math[n?"max":"min"](parseInt(o[1],10)+r,n?0:255)+", "+Math[n?"max":"min"](parseInt(o[2],10)+r,n?0:255)+(s!==null?", "+s:"")+")":["#",pad(Math[n?"max":"min"](parseInt(o[0],10)+r,n?0:255).toString(16),2),pad(Math[n?"max":"min"](parseInt(o[1],10)+r,n?0:255).toString(16),2),pad(Math[n?"max":"min"](parseInt(o[2],10)+r,n?0:255).toString(16),2)].join("")},lighterColor=function(e,t){return changeColor(e,t,!1)},darkerColor=function(e,t){return changeColor(e,t,!0)},hexToR=function(e){return parseInt(cutHex(e).substring(0,2),16)},hexToG=function(e){return parseInt(cutHex(e).substring(2,4),16)},hexToB=function(e){return parseInt(cutHex(e).substring(4,6),16)},cutHex=function(e){return e.charAt(0)=="#"?e.substring(1,7):e},hexToRGBA=function(e,t){return"rgba("+hexToR(e)+", "+hexToG(e)+", "+hexToB(e)+", "+t+")"};(function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator");t.DataLoader=function(){this.load=function(t){var n=e.ajax({type:"GET",url:t,cache:!1,dataType:"html",context:this}),r=n.promise();return r}}})(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.util"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.model");t.ExtraRepaymentUtil=function(){var e="loanRepaymentResults";this.mapControlsToVO=function(e){var t=e.getFrequency(),n=null;return n={pv:e.get("principal"),frequency:t,frequencyValue:t,interestRate:e.get("interestRate"),term:e.get("term")},n},this.mapControlsToVOExtra=function(e){var t=e.getFrequency(),n=null;return n={pv:e.get("principal"),frequency:t,frequencyValue:t,frequencyName:e.get("frequency"),interestRate:e.get("interestRate"),term:e.get("term"),extraRepaymentDiff:e.get("extraContribution"),extraRepaymentStartTerm:e.get("extraContributionStartYear")},n},this.getLoan=function(t){var r=gbst.calculator(t).loan();t.extraRepaymentDiff&&r.calculateRepayment().extraRepayment({pmtDiff:t.extraRepaymentDiff,startTerm:t.extraRepaymentStartTerm});var i=t.frequencyValue,s=r.pmt({update:!0}),o=t.pv,u=r.totalPmt(),a=u-o;return r.aggregate({reset:function(){this.loanSummaryResult=new n.LoanSummaryResult,this.chartSummary=this.loanSummaryResult.chartSummary,this.amortizationSummary=this.loanSummaryResult.amortizationSummary},updateResults:function(e,t,n){var r=Math.abs(t.outValues.pv),s=Math.abs(a-t.outValues.totals.interestEarned),o=Math.abs(u-t.outValues.totals.pmt);this.amortizationSummary.push({period:e,principalRemaining:r,interestRemaining:s,totalRemaining:o});if(e%i!=0)return;var f=e/i,l=t.outValues.pv;this.chartSummary.principalRemaining.push({period:e,x:f,y:l}),this.chartSummary.tooltipData.push({year:f,totalRemaining:l})},finaliseResults:function(t,n,r){var o=t-1;o%i!=0&&(this.chartSummary.principalRemaining.push({period:t,x:t/i,y:0}),this.chartSummary.tooltipData.push({year:t/i,totalRemaining:0})),this.loanSummaryResult.pmt=s,this.loanSummaryResult.interestEarned=n.outValues.totals.interestEarned,this.loanSummaryResult.nperRemaining=n.outValues.nperRemaining;var u=r.getStorage(e);u.result=this.loanSummaryResult,this.loanSummaryResult=null}}),r},this.calculate=function(t){var n=t.loan,r=t.loanExtra,i=n.calculateLoan(),s=r.calculateLoan(),o=i.getStorage(e),u=s.getStorage(e),a=o.result,f=u.result;o.result=null,delete o.result,u.result=null,delete u.result;var l=i.getLastSummary(),c=s.getLastSummary(),h=l.outValues.totals.interestEarned-c.outValues.totals.interestEarned,p=c.outValues.nperRemaining/c.inValues.frequencyValue,d=Math.floor(p),v=Math.floor(p*12%12),m=f.pmt+t.loanDataExtra.extraRepaymentDiff,g={amortizationSummary:f.amortizationSummary,originalLoanSummaryResult:a,extraRepaymentsSummaryResult:f,minRepayments:f.pmt,interestSaved:h,totalTimeSaved:{years:d,months:v},incRepayments:m,extraRepaymentStartTerm:t.loanDataExtra.extraRepaymentStartTerm,frequency:t.loanDataExtra.frequencyName};return g}}}(jQuery),function(e){var t=gbst.module("gbst.common.util"),n=480,r=300;t.ResponsiveUtil={appElement:null,dispatcher:null,fixedWidth:-1,previousWidth:-1,Events:{RESIZE:"responsiveUtil.Resize"},device_size:[{style:"default_layout",range:{min:980,max:Number.POSITIVE_INFINITY}},{style:"portrait_tablets_layout",range:{min:768,max:979}},{style:"phones_to_tablets_layout",range:{min:481,max:767}},{style:"phones_layout",range:{min:0,max:n}}],init:function(t,r,i){this.appElement=t,this.dispatcher=r,this.fixedWidth=i,this.appElement.css("max-width",i),this.fixedWidth<=n&&this.appElement.addClass("phones_layout"),e(window).resize(_.debounce(e.proxy(this.setLayout,this),20)),this.setLayout()},getStyle:function(e){var t=_.find(this.device_size,function(t,n){return t.range.min<=e&&e<=t.range.max});return t.style},setLayout:function(){var e=this.appElement,t=e.parent().width();if(t<=r&&this.previousWidth<=r&&this.previousWidth>0)return;if(t==this.previousWidth)return;this.previousWidth=t;var n=this.getStyle(t);e.removeClass(function(e,t){return(t.match(/\w+_layout/g)||[]).join(" ")}).addClass(n),t<this.fixedWidth&&e.addClass("responsive_layout"),this.dispatcher.trigger(this.Events.RESIZE)}}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.util.stylechange");t.applyStyleChanges=function(){var t=this.prepareContext(),n="extra-repayment-calculator/templates/style",r=HandlebarsTemplates[n](t);e("head").append(r)},t.prepareContext=function(){var e=I18n.t("colors");e.startColor=lighterColor(e.primaryColor,.03),e.hoverColor=e.endColor=darkerColor(e.primaryColor,.1),e.secondaryStartColor=lighterColor(e.secondaryColor,.03),e.secondaryEndColor=darkerColor(e.secondaryColor,.1),e.defaultColor=I18n.t("labels.resultsView.displayType.borderColor"),e.transparentColor="transparent";var t={colors:e};return t},t.changeSelectmenuColor=function(t){var n=I18n.t("colors.textColor"),r=t.find("select").each(function(){e(this).data("selectmenu").list.css("color",n)})}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.view");t.AmortizationTableView=Backbone.View.extend({templateId:"extra-repayment-calculator/templates/amortization-table",dispatcher:null,resultsModel:null,tableModel:null,events:{"click .next":"nextButton_handler","click .back":"backButton_handler"},initialize:function(t){this.controlsModel=t.controlsModel,this.tableModel=t.tableModel,this.resultsModel=t.resultsModel,this.resultsModel.on("change",e.proxy(this.updateTable_handler,this))},render:function(){this.verifyDisplayType();var e=this.prepareContext(),t=HandlebarsTemplates[this.templateId](e);return this.$el.empty().append(t),this.displayNextButton(),this.displayBackButton(),this},verifyDisplayType:function(){var e=this.$el;this.controlsModel.isDisplayTypeTable()?e.show():e.hide()},prepareContext:function(){var t=this.resultsModel.toJSON();t.tableData=this.tableModel.getCurrentSet();var n=this.getTableHeaders();return e.extend(t,n),t},getTableHeaders:function(){var e={},t="labels.resultsView.amortizationTable";return e.paymentPeriodHeader=I18n.t(t+".paymentNumberHeader"),e.principalHeader=I18n.t(t+".principalHeader"),e.interestHeader=I18n.t(t+".interestHeader"),e.balanceHeader=I18n.t(t+".balanceHeader"),e},displayNextButton:function(){var e=this.$el,t=e.find(".next");this.tableModel.isLastSet()?t.hide():t.show()},displayBackButton:function(){var e=this.$el,t=e.find(".back");this.tableModel.isFirstSet()?t.hide():t.show()},updateTable_handler:function(e){var t=this.tableModel;t.setCurrentIndex(0);var n=this.resultsModel.toJSON();t.setAmortizationSummary(n.amortizationSummary),this.render()},nextButton_handler:function(e){this.tableModel.getNextSet(),this.render()},backButton_handler:function(e){this.tableModel.getPreviousSet(),this.render()}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.view");t.ChartTooltipView=Backbone.View.extend({templateId:"extra-repayment-calculator/templates/chart-tooltip",wrapperClass:"chart-tooltip-wrapper",dispatcher:null,viewInitialised:!1,initialize:function(e){this.dispatcher=e.dispatcher,this.hide()},render:function(){return this.$el.addClass(this.wrapperClass),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},showData:function(e,t){var n=t[e],r=this.getTemplate(n);this.$el.empty().append(r)},getTemplate:function(e){var t=HandlebarsTemplates[this.templateId](e);return t}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.config.chart"),r=gbst.module("gbst.loan.app.extrarepaymentscalculator"),i=gbst.module("gbst.loan.app.extrarepaymentscalculator.view"),s=gbst.module("gbst.common.util");i.ChartView=Backbone.View.extend({resultsModel:null,dispatcher:null,templateId:"extra-repayment-calculator/templates/loan-chart",chartClass:"loan-chart",chartInstance:null,chartElement:null,tooltipView:null,hasPlotLine:!1,oldMouseOverIndex:null,tooltipData:null,initialize:function(t){this.dispatcher=e(t.dispatcher),this.createChartElements(this.$el),this.hideTooltip_proxy=e.proxy(this.hideTooltip,this),this.resultsModel=t.resultsModel,this.controlsModel=t.controlsModel,this.resultsModel.on("change",e.proxy(this.renderGraph,this)),this.controlsModel.on("change:displayType",e.proxy(this.displayTypeChange_handler,this)),this.dispatcher.bind(s.ResponsiveUtil.Events.RESIZE,e.proxy(this.resizeGraph,this))},renderGraph:function(){var t=this.resultsModel.get("originalLoanSummaryResult"),r=t.chartSummary,i=this.resultsModel.get("extraRepaymentsSummaryResult"),s=i.chartSummary,o=this.resultsModel.get("extraRepaymentStartTerm"),u=0,a=this.chartInstance,f=n.getChartSeries(),l=f.length,c=null,h=null,p=null;for(u=0;u<l;u++){h=f[u],c=a.series[u];switch(u){case 0:p=r[h.id];break;case 1:p=s[h.id]}if(!c)throw new Error("Could not find chart series ID='"+h.id+"'");c.setData(p,!1)}var d=[];_.each(r.tooltipData,function(t,n){var r={year:t.year,originalBalance:t.totalRemaining};if(n>o){var i=0;n<s.tooltipData.length&&(i=s.tooltipData[n].totalRemaining),e.extend(r,{balanceAfterExtraRepayments:i})}d.push(r)}),this.tooltipData=d,a.redraw()},render:function(){if(!this.viewInitialised){var e=this.controlsModel.get("displayType");e==t.displayType.GRAPH&&this.$el.show();var i=this,s=function(){i.dispatcher.trigger(r.Events.CHART_LOADED)},o=n.getChartConfig(this.chartElement[0],s);this.chartInstance=new Highcharts.Chart(o),this.initChartEvents(this.$el),this.viewInitialised=!0,e!=t.displayType.GRAPH&&this.$el.hide()}return this.tooltipView.render(),this},createChartElements:function(t){var n=gbst.util.getNewId(),r=HandlebarsTemplates[this.templateId]();r=e(r),r.attr("id",n),this.chartElement=r;var s=new i.ChartTooltipView({dispatcher:this.dispatcher});this.tooltipView=s,t.append(r,s.$el)},initChartEvents:function(n){var r=e.proxy(this.startTooltipTimer,this),i=e.proxy(this.chartTouchMouseMoveHandler,this);t.isTouchEnabled?(n.bind("touchstart touchmove",i),e(document).bind("touchstart",function(){r()})):(n.bind("mousemove",i),n.bind("mouseout",r))},chartTouchMouseMoveHandler:function(n){var r=this.chartInstance.series[0],i=r.xAxis,s=r.data,o=0,u=0,a=e(this.chartInstance.container).offset();if(!a)return;var f=n.originalEvent?n.originalEvent:{pageX:0,pageY:0};t.isTouchEnabled?(o=n.originalEvent.touches[0].pageX,u=n.originalEvent.touches[0].pageY):(o=n.pageX?n.pageX:f.pageX,u=n.pageY?n.pageY:f.pageY);var l=o-this.chartInstance.plotLeft-a.left,c=u-this.chartInstance.plotTop-a.top,h=Math.round(i.translate(l,!0));if(h>=0&&h<s.length){this.tooltipView.show(),this.oldMouseOverIndex!=h&&(this.oldMouseOverIndex=h,this.tooltipView.showData(h,this.tooltipData),this.tooltipShown=!0,this.showPlotLine(i,h));var p=o-a.left,d=u-a.top;this.positionTooltip(n,this.tooltipView,p,d),this.clearTooltipTimer()}else this.startTooltipTimer()},showPlotLine:function(e,t){this.hidePlotLine(e),e.addPlotLine({id:"mousePos",color:n.tooltip.indicatorColor,value:t,width:2,zIndex:15}),this.hasPlotLine=!0},hidePlotLine:function(e){if(!e){var t=this.chartInstance.series[0];e=t.xAxis}this.hasPlotLine&&(e.removePlotLine("mousePos"),this.hasPlotLine=!1)},positionTooltip:function(e,t,r,i){var s=t.$el,o=n.tooltip,u=e.type.indexOf("touch")>=0;u&&e.stopPropagation();var a=u?o.touchOffsetX:o.mouseOffsetX,f=u?o.touchOffsetY:o.mouseOffsetY,l=r+a,c=i+f,h=s.parent(),p=h.width(),d=h.height(),v=s.width(),m=s.height();v+l>p?(l=r-v-a,this.tooltipStyle==null&&(s.addClass("right"),this.tooltipStyle="right")):this.tooltipStyle!=null&&(s.removeClass("right"),this.tooltipStyle=null),l=Math.min(Math.max(0,l),p+v),c=Math.min(Math.max(0,c),d-m),s.css({left:l,top:c})},startTooltipTimer:function(){this.clearTooltipTimer(),this.seriesMouseOutTimeoutId=setTimeout(this.hideTooltip_proxy,250)},clearTooltipTimer:function(){this.seriesMouseOutTimeoutId!=null&&(clearTimeout(this.seriesMouseOutTimeoutId),this.seriesMouseOutTimeoutId=null)},hideTooltip:function(){this.clearTooltipTimer(),this.tooltipView.hide(),this.hidePlotLine()},hideTooltip_proxy:null,displayTypeChange_handler:function(e,n){n==t.displayType.GRAPH&&(this.renderGraph(),this.resizeGraph())},resizeGraph:function(){var e=this.controlsModel.get("displayType");if(e!=t.displayType.GRAPH)return;var n=this.chartInstance,r=this.chartElement.width(),i=this.chartElement.height();n.setSize(r,i,!1)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator"),r=gbst.module("gbst.loan.app.extrarepaymentscalculator.model"),i=gbst.module("gbst.loan.app.extrarepaymentscalculator.util.stylechange"),s=gbst.module("gbst.loan.app.extrarepaymentscalculator.view"),o=gbst.module("gbst.common.util");n.LoanCalculatorView=Backbone.View.extend({appTemplateId:"extra-repayment-calculator/templates/app-template",infoOverlayId:"extra-repayment-calculator/templates/information-overlay-tmpl",infoOverlayElement:null,dispatcher:null,viewInitialised:!1,controlsView:null,resultsView:null,chartView:null,displayTypeview:null,amortizationTableView:null,displayTypeFieldset:null,controlsModel:null,resultsModel:null,tableModel:null,events:{"click .print-icon":"print","click .info-icon":"infoClickHandler"},initialize:function(t){this.dispatcher=t.dispatcher,this.controlsModel=t.model,this.resultsModel=t.resultsModel,this.tableModel=t.tableModel,this.controlsModel.on("change:displayType",e.proxy(this.displayTypeHandler,this)),this.dispatcher.bind(n.Events.CHART_LOADED,e.proxy(this.registerCalculation,this)),this.dispatcher.bind(o.ResponsiveUtil.Events.RESIZE,e.proxy(this.resizeOverlay,this))},registerCalculation:function(){var e=this;_.defer(function(){e.dispatcher.trigger(n.Events.CALCULATE)})},render:function(){var e=this.$el;i.applyStyleChanges();var t=this.showDisplayType=I18n.t("labels.resultsView").showDisplayType;if(!this.viewInitialised){this.viewInitialised=!0;var n=this.prepareContext(),o=HandlebarsTemplates[this.appTemplateId](n);e.empty().append(o),this.charElement=this.$el.find(".chart-wrapper"),this.tableElement=this.$el.find(".amortization-table-wrapper"),this.controlsView=new s.LoanControlsView({controlsModel:this.controlsModel,resultsModel:this.resultsModel,dispatcher:this.dispatcher,el:e.find(".inputs-wrapper")}),this.resultsView=new s.ResultsView({dispatcher:this.dispatcher,resultsModel:this.resultsModel,el:e.find(".outputs-wrapper")}),this.chartView=new s.ChartView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,el:e.find(".chart-wrapper")});if(t){var u=r.DisplayTypeDeclaration(),a=u.elementSelector||"."+u.name;this.displayTypeView=new u.view({dispatcher:this.dispatcher,controlConfig:u,model:this.controlsModel,el:this.$el.find(a)}),this.amortizationTableView=new s.AmortizationTableView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,tableModel:this.tableModel,el:e.find(".amortization-table-wrapper")})}}return this.controlsView.render(),e.find(".gbst-loan-repayment").fadeIn(),this.resultsView.render(),this.chartView.render(),t&&(this.displayTypeView.render(),this.displayTypeFieldset=this.displayTypeView.$el.find("fieldset")),i.changeSelectmenuColor(e),this},prepareContext:function(){var e={};return e.calculatorTitle=I18n.t("labels.loanCalculator.calculatorTitle"),e.resultsHeader=I18n.t("labels.resultsView.resultsHeader"),e.disclaimer=I18n.t("labels.loanCalculator.disclaimer"),e},infoClickHandler:function(n){var r=this.infoOverlayElement;if(r==null){var i=HandlebarsTemplates[this.infoOverlayId]();i=e(i),this.$el.append(i),r=this.infoOverlayElement=i.overlay(t.infoOverlayConfig)}return r.overlay().load(),this.resizeOverlay(),r.css({top:0,left:0}),!1},resizeOverlay:function(){if(!this.infoOverlayElement)return;if(this.infoOverlayElement.is(":hidden"))return;var e=parseInt(this.$el.css("height"),10)-14;this.infoOverlayElement.css("height",e);var t=parseInt(this.$el.css("width"),10)-14;this.infoOverlayElement.css("width",t);var n=this.infoOverlayElement.find(".content");n.css("height",e-120)},displayTypeHandler:function(e){var r=e.get("displayType");r==t.displayType.GRAPH?(this.charElement.show(),this.dispatcher.triggerHandler(n.Events.CALCULATE,[this.controlsModel,this.resultsModel]),this.tableElement.hide()):(this.charElement.hide(),this.tableElement.show())},print:function(){window.print()}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.model"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.view"),r=gbst.module("gbst.loan.app.extrarepaymentscalculator.config.stylechange");n.LoanControlsView=Backbone.View.extend({dispatcher:null,controlsModel:null,resultsModel:null,controlsDeclaration:null,controlsList:null,DEFAULT_MAX_START_YEAR:0,DEFAULT_MAX_EXTRA_CONTRIBUTION:0,startYearControl:null,extraContributionControl:null,events:{},initialize:function(n){this.dispatcher=e(n.dispatcher),this.controlsModel=n.controlsModel,this.resultsModel=n.resultsModel,this.controlsDeclaration=t.ControlsDeclaration(),this.controlsList=[],this.controlsModel.on("change:term",this.updateStartYears_handler,this),this.resultsModel.on("change",e.proxy(this.updateExtraContribution_handler,this))},updateStartYears_handler:function(e,t){var n=this.DEFAULT_MAX_START_YEAR;this.updateControl(this.startYearControl,t-1,n)},updateExtraContribution_handler:function(e){var t=this.DEFAULT_MAX_EXTRA_CONTRIBUTION,n=this.controlsModel.get("extraContributionStartYear"),r=e.getRemainingPrincipal(n);this.updateControl(this.extraContributionControl,r,t)},getViewByModelId:function(e,t){var n=_.find(t,function(t,n){return t.controlConfig.name==e});return n},updateControl:function(e,t,n){t>n&&(t=n);if(t==e.getMaxValue())return;e.resetMaxValue(t),e.invalidateView(),e.render()},setDefaultValues:function(e){var t=this.startYearControl=this.getViewByModelId("extraContributionStartYear",e);t&&(this.DEFAULT_MAX_START_YEAR=t.getMaxValue());var n=this.extraContributionControl=this.getViewByModelId("extraContribution",e);n&&(this.DEFAULT_MAX_EXTRA_CONTRIBUTION=n.getMaxValue())},render:function(){var e=0,n=0,r=this.controlsList;if(!this.controlsCreated){this.$el.empty();var i=t.ControlsDeclaration();for(var e in i){var s=i[e],o=this.$el.find("."+s.id);this.createPanel(s,o)}this.controlsCreated=!0}n=r.length;for(e=0;e<n;e++)r[e].render();var u=this.controlsModel.get("term");return this.updateStartYears_handler(this.controlsModel,u),this},createPanel:function(e,t){var n=HandlebarsTemplates[e.id]();this.$el.append(n),this.createControls(this.$el,e.controls,this.controlsModel)},createControls:function(e,t,n){var r=0,i=null,s=t.length,o=null,u=null;for(r=0;r<s;r++)o=t[r],i=o.elementSelector||"."+o.name,u=new o.view({el:e.find(i),dispatcher:this.dispatcher,controlConfig:o,model:n}),this.controlsList.push(u);this.setDefaultValues(this.controlsList)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.view");t.ResultsView=Backbone.View.extend({templateId:"extra-repayment-calculator/templates/outputs-wrapper",resultsModel:null,initialize:function(t){this.resultsModel=t.resultsModel,this.resultsModel.on("change",e.proxy(this.renderResults,this))},renderResults:function(){var e=this.resultsModel.toJSON(),t=this.getMinRepaymentLabel(e.frequency);e.minRepaymentLabel=t;var n=this.getIncRepaymentLabel(e.frequency);e.incRepaymentLabel=n;var r=HandlebarsTemplates[this.templateId](e);this.$el.empty().append(r),this.$el=this.replaceYearsMonthsLabels(e.totalTimeSaved,this.$el)},replaceYearsMonthsLabels:function(e,t){var n=t.find("span.value.years"),r=t.find("span.label.years"),i=t.find("span.value.months"),s=t.find("span.label.months");return e.years==0&&e.months==0?(r.hide(),i.hide(),s.hide()):(e.years==0&&(n.hide(),r.hide()),e.months==0&&(i.hide(),s.hide())),t},getMinRepaymentLabel:function(e){var t="";return t=I18n.t("labels.resultsView.minRepayment."+e),t},getIncRepaymentLabel:function(e){var t="";return t=I18n.t("labels.resultsView.incRepayment."+e),t}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.control");n.APIController=function(){this.inputs=null,this.results=null,this.init=function(e,t,n){this.inputs=e,this.results=t,n&&this.restoreCalc(n)},this.getValues=function(){var e={inputs:this.inputs.toJSON(),results:this.results.toJSON()};return e},this.restoreCalc=function(e){this.inputs.set(e)}}}($),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator.config");I18n.defaultLocale="en",I18n.fallbacks=!0,t.style={styleSelectMenu:!0},t.infoOverlayConfig={fixed:!1,top:"0%",left:"0px"},t.periods={month:12,fortnight:26,week:52},t.displayType={GRAPH:"GRAPH",TABLE:"TABLE"},t.convertFn={numberConverter:function(e){var t=I18n.t("number.format.separator"),n=gbst.util.NumberUtil.parseNumber(e,t);return n},moneyConverter_back:function(e,t,n){var r=I18n.toCurrency(e,{precision:0});return r},listConverter:function(e){return e},listConverter_back:function(e){return[e]},interestConverter:function(e){var t=I18n.t("number.format.separator"),n=gbst.util.NumberUtil.parseNumber(e,t);return n},interestConverter_back:function(e){var t=I18n.toPercentage(e,{precision:2});return t}},t.isTouchEnabled=Modernizr.touch}(jQuery),function(e){var t=gbst.module("gbst.loan.app.extrarepaymentscalculator"),n=gbst.module("gbst.loan.app.extrarepaymentscalculator.model"),r=gbst.module("gbst.loan.app.extrarepaymentscalculator.util"),i=gbst.module("gbst.loan.app.extrarepaymentscalculator.control"),s=gbst.module("gbst.common.util");t.Events={CALCULATE:"extrarepaymentscalculator.calculate",CONTROL_CHANGE:"extrarepaymentscalculator.view.change",UPDATE_VIEW:"extrarepaymentscalculator.view.updateView",CHART_LOADED:"extrarepaymentscalculator.chartLoaded"},t.LoanCalculatorApp=function(o){this.dispatcher=e({}),this.parentEl=e(o),this.mainView=null,this.controlsModel=null,this.resultsModel=null,this.tableModel=null,this.storageAvailable=!1,this.init=function(t){e.support.cors=!0;if(t)this.options=t;else{var n=e.url().param("calc_settings");n&&(n=decodeURI(n),this.options=JSON.parse(n))}var r=614;s.ResponsiveUtil.init(this.parentEl,this.dispatcher,r),this.setupMainView()},this.loadDataError_proxy=function(e,t,n){console.log(e,t,n)},this.setupMainView=function(){try{ich.grabTemplates()}catch(r){console.log(r)}this.storageAvailable=window.localStorage!=null,this.controlsModel=new n.ControlValues,this.resultsModel=new n.ResultsModel,this.tableModel=new n.TableModel,this.apiController=new i.APIController,this.apiController.init(this.controlsModel,this.resultsModel,this.options),this.dispatcher.bind(t.Events.CONTROL_CHANGE,e.proxy(this.controlsChangeHandler,this)),this.initEvents(this.dispatcher),this.mainView=new t.LoanCalculatorView({dispatcher:this.dispatcher,model:this.controlsModel,resultsModel:this.resultsModel,tableModel:this.tableModel}),this.parentEl.append(this.mainView.$el),this.mainView.render()},this.initEvents=function(n){n.bind(t.Events.CALCULATE,e.proxy(this.calculate_handler,this));var r=this,i=_.debounce(function(){r.calculate(r.controlsModel,r.resultsModel)},100);this.controlsModel.on("change",i,this)},this.calculate_handler=function(e,t){this.calculate(this.controlsModel,this.resultsModel)},this.restorePreviousValues=function(){if(this.storageAvailable){var e=this;this.controlsModel.fetch({success:function(){e.mainView.render(),e.calculate(e.controlsModel,e.resultsModel)}})}},this.calculate=function(e,t){var n=this.calculateResults(e);t.set(n)},this.calculateResults=function(e){var t=new r.ExtraRepaymentUtil,n=t.mapControlsToVO(e),i=t.getLoan(n),s=t.mapControlsToVOExtra(e),o=t.getLoan(s),u={loan:i,loanExtra:o,loanDataExtra:s},a=t.calculate(u);return a},this.controlsChangeHandler=function(){this.storageAvailable&&this.controlsModel.save()},this.getCurrentValues=function(){return this.apiController.getValues()}}}(jQuery);