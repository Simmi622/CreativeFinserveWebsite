function setupConfig(e){var t=gbst.namespace("gbst.loan.app.borrowingpowercalculator.translations");t.en=e}(function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/amortization-table"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="amortization-content-panel">\n	<table id="gbst-amortization-table" class="amortization-table" summary="A table detailing each periodic payment on an amortizing loan">\n	</table>\n</div>\n'}),this.HandlebarsTemplates["borrowing-power-calculator/templates/amortization-table"]}).call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/app-template"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function";s+='	<div class="gbst-loan-repayment">\n\n		<div class="title">\n			<h1>',(o=n.calculatorTitle)?o=o.call(t,{hash:{},data:i}):(o=t.calculatorTitle,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</h1>\n			\n			<div class="info-panel">\n				<div class="button-wrapper"> \n					<button type="button" class="button info-icon" title="Information" role="button" aria-controls="information-overlay"></button>\n				</div>\n				\n				<div class="button-wrapper print"> \n					<button type="button" class="button print-icon" title="Print"></button>\n				</div>\n			</div>\n			\n			<div class="gbst-clear"></div>\n		</div>\n\n		<div class="content">\n			<div class="inputs-wrapper">\n				<div class="your-income-details"></div>\n				<div class="your-expenses-details"></div>\n				<div class="loan-details"></div>\n			</div>\n			\n			<div class="results-line">\n				<h3 class="results-title">',(o=n.resultsHeader)?o=o.call(t,{hash:{},data:i}):(o=t.resultsHeader,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</h3>\n			</div>\n\n			<div class="results-wrapper">\n				<div class="displayType"></div>\n				<div class="chart-wrapper"></div>\n				<div class="amortization-table-wrapper"></div>\n				<div class="outputs-wrapper" role="region" aria-live="polite"></div>\n				<div class="gbst-clear"></div>\n			</div>\n				\n			<div class="gbst-clear"></div>\n			<span class="calculator-disclaimer">',(o=n.disclaimer)?o=o.call(t,{hash:{},data:i}):(o=t.disclaimer,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="</span>\n		</div>\n	</div>\n",s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/app-template"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/chart-tooltip"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression;s+='<div class="arrow left"></div>\n\n<div class="chart-tooltip">\n	<div class="tooltip-title">',a={hash:{year:t.year},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.chartTooltip.title",a):f.call(t,"I18n","labels.chartTooltip.title",a)))+'</div>\n\n	<div class="interest-remaining">\n		<span class="summary-label">',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.chartView.interestRemainingTitle",a):f.call(t,"I18n","labels.chartView.interestRemainingTitle",a)))+'</span>\n		<span class="summary-value">',a={hash:{precision:0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.interestRemaining,a):f.call(t,"I18n-$",t.interestRemaining,a)))+'</span>\n		<div class="gbst-clear"></div>\n	</div>\n\n	<div class="principal-remaining">\n		<div class="symbol principal"></div>\n		<span class="summary-label">',a={hash:{},data:i},u=(o=n.I18n,o?o.call(t,"labels.chartView.principalRemainingTitle",a):f.call(t,"I18n","labels.chartView.principalRemainingTitle",a));if(u||u===0)s+=u;s+='</span>\n		<span class="summary-value">',a={hash:{precision:0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.principalRemaining,a):f.call(t,"I18n-$",t.principalRemaining,a)))+'</span>\n		<div class="gbst-clear"></div>\n	</div>\n\n	<div class="line"></div>\n\n	<div class="total-remaining">\n		<div class="symbol total"></div>\n		<span class="summary-label">',a={hash:{},data:i},u=(o=n.I18n,o?o.call(t,"labels.chartView.totalRemainingTitle",a):f.call(t,"I18n","labels.chartView.totalRemainingTitle",a));if(u||u===0)s+=u;return s+='</span>\n		<span class="summary-value">',a={hash:{precision:0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.totalRemaining,a):f.call(t,"I18n-$",t.totalRemaining,a)))+'</span>\n		<div class="gbst-clear"></div>\n	</div>\n</div>\n\n<div class="arrow right"></div>	\n',s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/chart-tooltip"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/information-overlay-tmpl"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression;s+='<div id="information-overlay" class="modal-overlay" role="article">\n	<div class="wrapper">\n		<button type="button" class="close" role="button" aria-label="close" tabindex="0"></button>\n		<h2 tabindex="0">',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===u?o.apply(t):o),s+=a(o)+'</h2>\n		<div class="content" tabindex="0">\n			',(o=n.content)?o=o.call(t,{hash:{},data:i}):(o=t.content,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="\n		</div>\n	</div>\n</div>\n",s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/information-overlay-tmpl"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/loan-chart"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="loan-chart"></div>\n'}),this.HandlebarsTemplates["borrowing-power-calculator/templates/loan-chart"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/loan-details"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="section loan-details-section">\n	<h2>\n		<span class="number-wrapper">3</span>\n		<span class="title-wrapper">',u={hash:{},data:i},s+=f((o=n.I18n,o?o.call(t,"labels.loanDetailsControlsView.controlsTitle",u):a.call(t,"I18n","labels.loanDetailsControlsView.controlsTitle",u)))+'</span>\n	</h2>\n	\n	<div class="expandable">\n		<ul class="controls-wrapper">\n			<li class="interestRate slider-wrapper"></li>\n			<li class="term slider-wrapper no-right-margin"></li>\n\n			<div class="gbst-clear"></div>\n		</ul>\n	</div>\n</div>\n',s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/loan-details"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/outputs-wrapper"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c="function";return s+='<div>\n	<div class="results-responsive">\n		<div class="results-arrow"></div>\n		<div class="results-box frequency-result">\n			<div class="result-content">\n				<span class="label">',a={hash:{},data:i},s+=l((o=n.I18n,o?o.call(t,"labels.resultsView.borrowingAmountLabel",a):f.call(t,"I18n","labels.resultsView.borrowingAmountLabel",a)))+'</span><br/>\n				<span class="value">',a={hash:{precision:0,html:!0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.pv,a):f.call(t,"I18n-$",t.pv,a)))+'</span>\n			</div>\n		</div>\n\n		<div class="results-box total-result">\n			<div class="result-content">\n				<span class="label">',(u=n.frequencyLabel)?u=u.call(t,{hash:{},data:i}):(u=t.frequencyLabel,u=typeof u===c?u.apply(t):u),s+=l(u)+'</span><br/>\n				<span class="value small">',a={hash:{precision:0,html:!0},data:i},s+=l((o=n["I18n-$"],o?o.call(t,t.pmt,a):f.call(t,"I18n-$",t.pmt,a)))+"</span>\n			</div>\n		</div>\n	</div>\n</div>\n",s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/outputs-wrapper"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/radio-buttons-input"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<span class="radio-buttons-label">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</span>\n	\n	<fieldset class="radio-buttons-wrapper">\n		<legend>',(i=n.legend)?i=i.call(e,{hash:{},data:t}):(i=e.legend,i=typeof i===a?i.apply(e):i),r+=f(i)+"</legend>",r}function p(e,t){var r="",i,s;r+="\n			",s={hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t},(i=n.radioButtonData)?i=i.call(e,s):(i=e.radioButtonData,i=typeof i===a?i.apply(e):i),n.radioButtonData||(i=c.call(e,i,s));if(i||i===0)r+=i;return r+="\n		",r}function d(e,t){var r="",i;return r+='\n				<input id="radio-',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'" type="radio" name="radio-group" value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'"/>\n				<label for="radio-',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>\n			",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+='<div class="radio">\n	',u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+="\n		",u={hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i},(o=n.controlData)?o=o.call(t,u):(o=t.controlData,o=typeof o===a?o.apply(t):o),n.controlData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='\n		\n		<div class="gbst-clear"></div>\n	</fieldset>	\n	\n	<div class="gbst-clear"></div>\n</div>\n',s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/radio-buttons-input"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/style"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+="\n	.borrowing-power-calculator-app .inputs-wrapper h2 {\n		background-color: ",(i=n.subtitleBgColor)?i=i.call(e,{hash:{},data:t}):(i=e.subtitleBgColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		color: ",(i=n.subtitleColor)?i=i.call(e,{hash:{},data:t}):(i=e.subtitleColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.borrowing-power-calculator-app .number-wrapper, .borrowing-power-calculator-app .results-line .results-title {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		color: ",(i=n.titleColor)?i=i.call(e,{hash:{},data:t}):(i=e.titleColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important; \n	}\n	.borrowing-power-calculator-app .info-panel .info-icon, .borrowing-power-calculator-app .info-panel .print-icon {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.borrowing-power-calculator-app .slider .progress {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.borrowing-power-calculator-app .info-panel .info-icon:hover, .borrowing-power-calculator-app .info-panel .print-icon:hover {\n		background-color: ",(i=n.hoverColor)?i=i.call(e,{hash:{},data:t}):(i=e.hoverColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important; \n	}\n	.borrowing-power-calculator-app h1, .borrowing-power-calculator-app .standard-label, .borrowing-power-calculator-app input.range,\n	.borrowing-power-calculator-app .radio-buttons-label, .borrowing-power-calculator-app .slider-label, .borrowing-power-calculator-app .dependants .ui-state-default,\n	.borrowing-power-calculator-app .results-box span, .borrowing-power-calculator-app .modal-overlay, .borrowing-power-calculator-app .currentTaxThresholds,\n	.borrowing-power-calculator-app span.ui-selectmenu-status, .borrowing-power-calculator-app .checkbox-label span,\n	.borrowing-power-calculator-app .amortization-table-wrapper, .borrowing-power-calculator-app .chart-tooltip {\n		color: ",(i=n.textColor)?i=i.call(e,{hash:{},data:t}):(i=e.textColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.borrowing-power-calculator-app .dependants .ui-state-active {\n		color: #FFFFFF !important;\n	}\n	.borrowing-power-calculator-app .dependants .ui-buttonset .ui-state-active {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	}\n	.borrowing-power-calculator-app .displayType label {\n		color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		background-color: ",(i=n.transparentColor)?i=i.call(e,{hash:{},data:t}):(i=e.transparentColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		border-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+";\n	}\n	.borrowing-power-calculator-app .displayType label.ui-state-active {\n		color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		background-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		border-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+";\n	}\n	.borrowing-power-calculator-app .displayType label:hover {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	} \n	.borrowing-power-calculator-app .displayType label.ui-state-active:hover {\n		cursor: default !important;\n		background: none !important;\n		filter: none !important;\n		background-color: ",(i=n.defaultColor)?i=i.call(e,{hash:{},data:t}):(i=e.defaultColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n	}\n	.borrowing-power-calculator-app .symbol.total {\n		background-color: ",(i=n.secondaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.secondaryStartColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryStartColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.secondaryEndColor)?i=i.call(e,{hash:{},data:t}):(i=e.secondaryEndColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	} \n	.borrowing-power-calculator-app .symbol.principal {\n		background-color: ",(i=n.primaryColor)?i=i.call(e,{hash:{},data:t}):(i=e.primaryColor,i=typeof i===a?i.apply(e):i),r+=f(i)+" !important;\n		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"' , endColorstr='",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"') !important;\n		background: -webkit-gradient(linear, left top, left bottom, from(",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+"), to(",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+")) !important;\n		background: -moz-linear-gradient(top, ",(i=n.startColor)?i=i.call(e,{hash:{},data:t}):(i=e.startColor,i=typeof i===a?i.apply(e):i),r+=f(i)+", ",(i=n.endColor)?i=i.call(e,{hash:{},data:t}):(i=e.endColor,i=typeof i===a?i.apply(e):i),r+=f(i)+") !important;\n	} \n	",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+="<style>\n	",u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.colors)?o=o.call(t,u):(o=t.colors,o=typeof o===a?o.apply(t):o),n.colors||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</style>\n",s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/style"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/your-expenses-details"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="section expenses-details-section" role="region" aria-live="polite">\n	<h2>\n		<span class="number-wrapper">2</span>\n		<span class="title-wrapper">',u={hash:{},data:i},s+=f((o=n.I18n,o?o.call(t,"labels.yourExpensesControlsView.controlsTitle",u):a.call(t,"I18n","labels.yourExpensesControlsView.controlsTitle",u)))+'</span>\n	</h2>  \n	\n	<div class="expandable">\n		<ul class="controls-wrapper dependants-panel">\n			<li class="dependants radio-button-wrapper"></li>\n\n			<div class="gbst-clear"></div>\n		</ul>\n\n		<ul class="controls-wrapper annual-expenses-panel">\n			<li class="slider-wrapper">\n				<div class="input no-float annualExpenses"></div>\n				<div class="input no-float useDefault checkbox"></div>	<div style="margin-left:0px; font-weight:bold; padding-top:10px;">Select Expense as 40% of your Annual Income</div>		\n			</li>\n			<li class="slider-wrapper">\n				<div class="input no-float carLoanRepayment"></div>\n				<div class="input no-float carLoanRepaymentFrequency"></div>			\n			</li>\n\n			<div class="gbst-clear"></div>\n		</ul>\n\n		<ul class="controls-wrapper credit-card-panel">\n			<li class="slider-wrapper">\n				<div class="input no-float creditCardRepayment"></div>\n				<div class="input no-float creditCardRepaymentFrequency"></div>\n			</li>\n			<li class="slider-wrapper">\n				<div class="input no-float otherPayments"></div>\n				<div class="input no-float otherPaymentsFrequency"></div>\n			</li>\n\n			<div class="gbst-clear"></div>\n		</ul>\n	</div>\n</div>\n',s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/your-expenses-details"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["borrowing-power-calculator/templates/your-income-details"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="section" role="region" aria-live="polite">\n	<h2>\n		<span class="number-wrapper">1</span>\n		<span class="title-wrapper">',u={hash:{},data:i},s+=f((o=n.I18n,o?o.call(t,"labels.yourIncomeControlsView.controlsTitle",u):a.call(t,"I18n","labels.yourIncomeControlsView.controlsTitle",u)))+'</span>\n	</h2>  \n\n	<div class="expandable">\n		<ul class="controls-wrapper">\n			<li>\n				<div class="input primarySalary small-right-margin"></div>\n				<div class="input primarySalaryTax small-right-margin borrowing-power-selectmenu-short"></div>\n				<div class="input primarySalaryFrequency borrowing-power-selectmenu"></div>\n			</li>\n\n			<li class="input-wrapper">\n				<div class="input otherIncome small-right-margin"></div>\n				<div class="input otherIncomeTax small-right-margin borrowing-power-selectmenu-short"></div>\n				<div class="input otherIncomeFrequency no-right-margin borrowing-power-selectmenu"></div>\n			</li>\n\n			<div class="gbst-clear"></div>\n		</ul>\n\n		<ul class="controls-wrapper partner-panel">\n			<li class="hasJointIncome"></li>\n			<div class="gbst-clear"></div>\n		</ul>\n\n		<ul class="controls-wrapper secondary-salary-panel">\n			<li>\n				<div class="input secondarySalary small-right-margin"></div>\n				<div class="input secondarySalaryTax small-right-margin borrowing-power-selectmenu-short"></div>\n				<div class="input secondarySalaryFrequency borrowing-power-selectmenu"></div>\n			</li>\n			<div class="gbst-clear"></div>\n		</ul>\n	</div>\n</div>\n',s}),this.HandlebarsTemplates["borrowing-power-calculator/templates/your-income-details"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["slider-input/templates/slider-input-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<label class="slider-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</label><input id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i),r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='" name="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'" type="range" required="true"></input>\n<div class="gbst-clear"></div>\n',s}),this.HandlebarsTemplates["slider-input/templates/slider-input-templates"]}.call(this),function(){Handlebars.registerPartial("selectmenu/templates/_select-control",Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<select id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" name="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="standard-input ',(i=n.controlClass)?i=i.call(e,{hash:{},data:t}):(i=e.controlClass,i=typeof i===a?i.apply(e):i),r+=f(i),r}function p(e,t){var r="",i,s;r+="\n		",s={hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t},(i=n.listData)?i=i.call(e,s):(i=e.listData,i=typeof i===a?i.apply(e):i),n.listData||(i=c.call(e,i,s));if(i||i===0)r+=i;return r+="\n	",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+"</option>\n		",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+='">\n	',u={hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i},(o=n.controlData)?o=o.call(t,u):(o=t.controlData,o=typeof o===a?o.apply(t):o),n.controlData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</select>\n",s}))}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["selectmenu/templates/selectmenu-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='<label class="standard-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.titleString)?i=i.call(e,{hash:{},data:t}):(i=e.titleString,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,r=r||e.partials,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+="\n",o=l.invokePartial(r["selectmenu/templates/_select-control"],"selectmenu/templates/_select-control",t,n,r,i);if(o||o===0)s+=o;return s+='\n\n<div class="gbst-clear"></div>\n\n\n',s}),this.HandlebarsTemplates["selectmenu/templates/selectmenu-templates"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["standard-input/templates/standard-input-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='\n<label class="standard-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</label>\n<input id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i),r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='" name="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'" maxlength="'+f((o=(o=(o=t.controlData,o==null||o===!1?o:o.inputData),o==null||o===!1?o:o.maxlength),typeof o===a?o.apply(t):o))+'" class="range standard-input" type="text"></input>\n<div class="gbst-clear"></div>\n',s}),this.HandlebarsTemplates["standard-input/templates/standard-input-templates"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["radiogroup-input/templates/radiogroup-input"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i,s;r+='\n	\n	<p class="radiogroup-label">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===a?i.apply(e):i),r+=f(i)+'</p>\n\n	<fieldset id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">\n		<legend>',(i=n.legend)?i=i.call(e,{hash:{},data:t}):(i=e.legend,i=typeof i===a?i.apply(e):i),r+=f(i)+"</legend>\n		",s={hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t},(i=n.radiosData)?i=i.call(e,s):(i=e.radiosData,i=typeof i===a?i.apply(e):i),n.radiosData||(i=c.call(e,i,s));if(i||i===0)r+=i;return r+="\n	</fieldset>\n	\n	",r}function p(e,t){var r="",i;return r+='\n			<input type="radio" id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" name="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===a?i.apply(e):i),r+=f(i)+'" value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===a?i.apply(e):i),r+=f(i)+'"/>\n			<label for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="',(i=n.clazz)?i=i.call(e,{hash:{},data:t}):(i=e.clazz,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>\n		",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+='<div class="radio">\n	',u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+="\n</div>\n",s}),this.HandlebarsTemplates["radiogroup-input/templates/radiogroup-input"]}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates["checkbox-input/templates/checkbox-input-templates"]=Handlebars.template(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='\n<input id="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i),r}function p(e,t){var r="",i;return r+='\n<label class="checkbox-label" for="',(i=n.controlId)?i=i.call(e,{hash:{},data:t}):(i=e.controlId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',(i=n.titleString)?i=i.call(e,{hash:{},data:t}):(i=e.titleString,i=typeof i===a?i.apply(e):i),r+=f(i)+"</label>\n",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.blockHelperMissing;s+='<div class="check-box-input">\n',u={hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;s+='" name="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'" class="checkbox-input" type="checkbox" value="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></input>\n',u={hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i},(o=n.templateData)?o=o.call(t,u):(o=t.templateData,o=typeof o===a?o.apply(t):o),n.templateData||(o=c.call(t,o,u));if(o||o===0)s+=o;return s+='\n<div class="gbst-clear"></div>\n</div>\n',s}),this.HandlebarsTemplates["checkbox-input/templates/checkbox-input-templates"]}.call(this),function(e){var t=gbst.namespace("incometax");t.IncomeTaxManager=function(){this.loadFile=function(t){var n=null;return t&&(n=e.ajax({type:"GET",url:t,cache:!1,dataType:"xml",error:function(){}})),n},this.parseRawData=function(t){var n=e.xml2json(t);return n},this.calculateNetIncome=function(e,t){var n=e,r=0,i=e,s=0,o=0,u=0,a=0;while(r<t.length&&i>0){var f=t[r],l=f.lowerBound,c=f.upperBound,h=f.taxRate,p=l-a,d=c-a;i>=d&&d>-1?(u=d,i-=d):(u=i,i=0),o=u*h,s+=o,a=c,r++}var v=n-s,m={totalAnnualTax:s,netAnnualIncome:v};return m}}}(jQuery),function(e){Handlebars.registerHelper("I18n",function(e,t){var n=t;t&&t.hash&&(n=t.hash);var r="";return I18n?e!=null?r=I18n.t(e,n):r="Invalid 'str' value":r=e,r}),Handlebars.registerHelper("I18n-$",function(t,n){var r=n;n&&n.hash&&(r=n.hash);if(r.html){var i=I18n.t("number.currency.format.htmlFormat");e.extend(r,{format:i})}var s="";return I18n?t!=null?s=I18n.toCurrency(t,r):s="Invalid 'str' value":s=t,new Handlebars.SafeString(s)})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config.chart");t.getChartConfig=function(t,n){var r={color:I18n.t("colors.textColor"),fontWeight:"bold",fontSize:"11px",fontFamily:"Arial, Verdana"},i={color:I18n.t("colors.textColor"),fontWeight:"bold",fontSize:"13px",fontFamily:"Arial, Verdana"},s={parentId:"loan-chart",chart:{backgroundColor:"rgba(255,255,255,0.5)",defaultSeriesType:"area",plotShadow:!1,reflow:!1,marginTop:40,spacingTop:0,spacingBottom:0,spacingRight:20,spacingLeft:10,borderRadius:0,renderTo:t,events:{load:n}},colors:["#0782be","#005c88"],credits:{enabled:!1},legend:{layout:"horizontal",backgroundColor:"rgba(255,255,255,0.33)",align:"right",verticalAlign:"top",x:0,y:5,floating:!0,borderRadius:5,borderWidth:0,itemStyle:{color:I18n.t("colors.textColor"),cursor:"default",fontWeight:"normal",fontSize:"12px",fontFamily:"Arial, Verdana"},itemHoverStyle:{color:I18n.t("colors.textColor")}},xAxis:{endOnTick:!0,labels:{style:r,y:20},lineColor:"#e1e1e1",lineWidth:1,maxPadding:0,min:0,title:{align:"middle",style:i,margin:20},tickColor:"#666666",tickPlacement:"on",tickPosition:"outside",tickWidth:2,tickLength:3},yAxis:{gridLineColor:"#e1e1e1",gridLineWidth:1,allowDecimals:!1,labels:{style:r},lineColor:"#e1e1e1",lineWidth:1,min:0,title:{style:i},tickColor:"#666666",tickPlacement:"on",tickPosition:"outside",tickWidth:2,tickLength:3},plotOptions:{series:{animation:!0,enableMouseTracking:!1,pointPadding:0,groupPadding:0,events:{legendItemClick:function(){return!1}}},area:{lineWidth:0,fillOpacity:1,connectNulls:!0,marker:{radius:0,lineWidth:0}}},title:{text:null}},o={title:{},xAxis:{title:{text:I18n.t("labels.chartView.xAxisTitle")}},yAxis:{title:{text:I18n.t("labels.chartView.yAxisTitle",{unit:I18n.t("number.currency.format.unit")})}},series:this.getChartSeries(),tooltip:{enabled:!1}};return e.extend(!0,s,o),s},t.getChartSeries=function(){return[{id:"totalRemaining",name:I18n.t("labels.chartView.totalRemainingTitle"),borderWidth:0,color:{linearGradient:[0,0,200,0],stops:[[0,lighterColor(I18n.t("colors.secondaryColor"),.1)],[1,darkerColor(I18n.t("colors.secondaryColor"),.1)]]},shadow:!1},{id:"principalRemaining",name:I18n.t("labels.chartView.principalRemainingTitle"),borderWidth:0,color:{linearGradient:[0,0,200,0],stops:[[0,lighterColor(I18n.t("colors.primaryColor"),.1)],[1,darkerColor(I18n.t("colors.primaryColor"),.1)]]},shadow:!1}]},t.tooltip={indicatorColor:"rgba(204, 204, 204, 0.3)",mouseOffsetX:5,mouseOffsetY:-30,touchOffsetX:0,touchOffsetY:-170}}(jQuery),function(e){var t=gbst.namespace("gbst.loan.app.borrowingpowercalculator.translations");I18n.translations=I18n.translations||{},I18n.translations.en=t.en}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.model");n.ControlValues=Backbone.Model.extend({localStorage:null,defaults:{hasJointIncome:!1,primarySalary:-1,primarySalaryTax:"",primarySalaryFrequency:"",secondarySalary:-1,secondarySalaryTax:"",secondarySalaryFrequency:"",otherIncome:-1,otherIncomeTax:"",otherIncomeFrequency:"",dependants:-1,annualExpenses:-1,useDefault:!0,carLoanRepayment:-1,carLoanRepaymentFrequency:"",creditCardRepayment:-1,creditCardRepaymentFrequency:"",otherPayments:-1,otherPaymentsFrequency:"",interestRate:-1,term:-1,principal:-1,frequency:"",repaymentType:"",displayType:""},initialize:function(){window.localStorage&&(this.localStorage=new Store("gbst.loan.app.borrowingpowercalculator"))},parse:function(t){return e.isArray(t)&&t.length>0&&(t=_.first(t)),t},getFrequency:function(e){var n=this.get(e),r=t.periods[n];if(!r)throw new Error("Missing frequency value for frequency type: '"+n+"'");return r},getUseDefault:function(){return this.get("useDefault")},getHasJointIncome:function(){return this.get("hasJointIncome")},getDependants:function(){return this.get("dependants")},setAnnualExpenses:function(e){this.set("annualExpenses",e)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.model"),r=gbst.module("gbst.loan.app.borrowingpowercalculator.view"),i=gbst.module("gbst.loan.shared.view");n.ControlsDeclaration=function(){return{income:{id:"borrowing-power-calculator/templates/your-income-details",controls:[{name:"hasJointIncome",view:i.CheckBoxInputView,templateId:"checkbox-input/templates/checkbox-input-templates",templateData:{title:"labels.yourIncomeControlsView.hasJointIncomeLabel",controlId:gbst.util.getNewId()}},{name:"primarySalary",view:i.StandardInputView,templateId:"standard-input/templates/standard-input-templates",templateData:{title:"labels.yourIncomeControlsView.primarySalaryLabel",controlId:gbst.util.getNewId(),labelClass:"",controlClass:""},controlData:{inputData:I18n.t("defaults.controls.primarySalary")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"primarySalaryTax",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.primarySalaryTaxLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.tax")}},{name:"primarySalaryFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.primarySalaryFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}},{name:"secondarySalary",view:i.StandardInputView,templateId:"standard-input/templates/standard-input-templates",templateData:{title:"labels.yourIncomeControlsView.secondarySalaryLabel",controlId:gbst.util.getNewId()},controlData:{inputData:I18n.t("defaults.controls.secondarySalary")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"secondarySalaryTax",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.secondarySalaryTaxLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.tax")}},{name:"secondarySalaryFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.secondarySalaryFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}},{name:"otherIncome",view:i.StandardInputView,templateId:"standard-input/templates/standard-input-templates",templateData:{title:"labels.yourIncomeControlsView.otherIncomeLabel",controlId:gbst.util.getNewId()},controlData:{inputData:I18n.t("defaults.controls.otherIncome")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"otherIncomeTax",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.otherIncomeTaxLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.tax")}},{name:"otherIncomeFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourIncomeControlsView.otherIncomeFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}}]},expenses:{id:"borrowing-power-calculator/templates/your-expenses-details",controls:[{name:"dependants",view:i.RadiogroupView,templateId:"borrowing-power-calculator/templates/radio-buttons-input",templateData:{controlId:gbst.util.getNewId(),title:"labels.yourExpensesControlsView.dependantsLabel",legend:"labels.yourExpensesControlsView.dependantsLabel"},controlData:{radioButtonData:I18n.t("defaults.controls.dependants")},parser:t.convertFn.numberConverter,modelToControlFormatter:t.convertFn.numberParser_back,controlToModelFormatter:t.convertFn.numberParser},{name:"annualExpenses",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.yourExpensesControlsView.annualExpensesLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.annualExpenses")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"useDefault",view:i.CheckBoxInputView,templateId:"checkbox-input/templates/checkbox-input-templates",templateData:{title:"labels.yourExpensesControlsView.useDefaultLabel",controlId:gbst.util.getNewId()}},{name:"carLoanRepayment",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.yourExpensesControlsView.carLoanRepaymentLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.carLoanRepayment")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"carLoanRepaymentFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourExpensesControlsView.carLoanRepaymentFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}},{name:"creditCardRepayment",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.yourExpensesControlsView.creditCardRepaymentLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.creditCardRepayment")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"creditCardRepaymentFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourExpensesControlsView.creditCardRepaymentFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}},{name:"otherPayments",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.yourExpensesControlsView.otherPaymentsLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.otherPayments")},formatter:t.convertFn.moneyConverter_back,parser:t.convertFn.numberConverter},{name:"otherPaymentsFrequency",view:i.SelectmenuView,templateId:"selectmenu/templates/selectmenu-templates",templateData:{title:"labels.yourExpensesControlsView.otherPaymentsFrequencyLabel",controlId:gbst.util.getNewId()},controlData:{listData:I18n.t("defaults.controls.frequency")}}]},loan:{id:"borrowing-power-calculator/templates/loan-details",controls:[{name:"interestRate",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanDetailsControlsView.interestRateLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.interestRate")},formatter:t.convertFn.interestConverter_back,parser:t.convertFn.interestConverter},{name:"term",view:i.SliderView,templateId:"slider-input/templates/slider-input-templates",templateData:{title:"labels.loanDetailsControlsView.termLabel",controlId:gbst.util.getNewId()},controlData:{sliderData:I18n.t("defaults.controls.term")},formatter:function(e){var t=I18n.t("labels.loanDetailsControlsView.termFormat",{count:e});return t},parser:t.convertFn.numberConverter}]}}},n.DisplayTypeDeclaration=function(){return{name:"displayType",view:i.RadiogroupView,templateId:"radiogroup-input/templates/radiogroup-input",templateData:{controlId:gbst.util.getNewId(),title:"",legend:"",radiosData:[{controlId:gbst.util.getNewId(),name:"chart-table",value:t.displayType.GRAPH,label:I18n.t("labels.resultsView.displayType.graph")},{controlId:gbst.util.getNewId(),name:"chart-table",value:t.displayType.TABLE,label:I18n.t("labels.resultsView.displayType.table")}]}}}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.model");n.CreditCardExpenseModel=Backbone.Model.extend({defaults:{useCreditCardLimitExpense:!1,creditCardLimitExpense:-1,creditCardLimitExpenseLabel:""}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.model");t.LoanSummaryResult=function(){this.pmt=0,this.totalInterestPaid=0,this.chartSummary=new t.ChartSummaryModel,this.amortizationSummary=[]},t.ChartSummaryModel=function(){this.principalRemaining=[],this.interestRemaining=[],this.totalRemaining=[],this.tooltipData=[]}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.model");t.ResultsModel=Backbone.Model.extend({defaults:{amortizationSummary:[],chartSummary:null,frequency:"",pmt:-1,pv:-1,totalInterestPaid:-1}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.model");n.ServiceabilityModel=Backbone.Model.extend({defaults:{singleBaseExpense:-1,singleDependentAdditionalExpense:-1,jointBaseExpense:-1,jointDependentAdditionalExpense:-1,servicableIncomeFactor:-1,useIntRateBufferFlag:!0,interestRateBuffer:-1,defaultBPIntRate:-1},getInterestRateBuffer:function(){return this.get("interestRateBuffer")*100},getUseBufferFlag:function(){return this.get("useIntRateBufferFlag")},getDefaultRateWithoutBuffer:function(){return this.get("defaultBPIntRate")}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.control");n.BorrowingPowerController=function(){this.dispatcher=null,this.resolver=null,this.controlsModel=null,this.resultsModel=null,this.loanRepaymentUtil=null,this.serviceabilityModel=null,this.creditCardExpenseModel=null,this.init=function(n,r){this.dispatcher=n,this.resolver=r,this.controlsModel=r.controlsModel,this.resultsModel=r.resultsModel,this.loanRepaymentUtil=r.loanRepaymentUtil,this.serviceabilityModel=r.serviceabilityModel,this.creditCardExpenseModel=r.creditCardExpenseModel,this.dispatcher.bind(t.Events.CONTROL_CHANGE,e.proxy(this.controlsChangeHandler,this)),this.dispatcher.bind(t.Events.CALCULATE,e.proxy(this.calculate_handler,this));var i=this,s=_.debounce(function(){i.dispatcher.trigger(t.Events.CALCULATE,[i.controlsModel,i.resultsModel])},100);this.controlsModel.on("change",s,this),this.controlsModel.on("change:useDefault",e.proxy(this.useDefault_change,this)),this.controlsModel.on("change:dependants",e.proxy(this.dependants_change,this)),this.controlsModel.on("change:hasJointIncome",e.proxy(this.hasJointIncome_handler,this)),this.calculateDefaultAnnualExpense(this.controlsModel,!0)},this.calculate_handler=function(e,t,n){this.calculate(t,n)},this.calculate=function(e,t){var n=this.calculateResults(e);t.set(n)},this.calculateResults=function(e){var t=this.loanRepaymentUtil,n=t.mapControlsToVO(e),r=t.getLoan(n),i=t.calculate(r),s=_.extend({frequency:e.get("frequency")},i);return this.results=s,s},this.controlsChangeHandler=function(){this.storageAvailable&&this.controlsModel.save()},this.useDefault_change=function(e){var t=this.getAnnualDependantsExpenses(e);e.setAnnualExpenses(t)},this.hasJointIncome_handler=function(e){this.calculateDefaultAnnualExpense(e)},this.dependants_change=function(e){this.calculateDefaultAnnualExpense(e)},this.calculateDefaultAnnualExpense=function(e,t){t==null&&(t=!1);if(e.getUseDefault()){var n=this.getAnnualDependantsExpenses(e);e.set({annualExpenses:n},{silent:t})}},this.getAnnualDependantsExpenses=function(e){var t=this.loanRepaymentUtil.calculateAnnualDependantsExpenses(e.getHasJointIncome(),e.getDependants());return t}}}(jQuery);var pad=function(e,t){var n="0";e+="";while(e.length<t)e=n+e;return e},changeColor=function(e,t,n){e=e.replace(/^\s*|\s*$/,""),e=e.replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");var r=Math.round(t*256)*(n?-1:1),i=e.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),s=!i||i[4]==null?null:i[4],o=i?[i[1],i[2],i[3]]:e.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return parseInt(arguments[1],16)+","+parseInt(arguments[2],16)+","+parseInt(arguments[3],16)}).split(/,/),u;return i?"rgb"+(s!==null?"a":"")+"("+Math[n?"max":"min"](parseInt(o[0],10)+r,n?0:255)+", "+Math[n?"max":"min"](parseInt(o[1],10)+r,n?0:255)+", "+Math[n?"max":"min"](parseInt(o[2],10)+r,n?0:255)+(s!==null?", "+s:"")+")":["#",pad(Math[n?"max":"min"](parseInt(o[0],10)+r,n?0:255).toString(16),2),pad(Math[n?"max":"min"](parseInt(o[1],10)+r,n?0:255).toString(16),2),pad(Math[n?"max":"min"](parseInt(o[2],10)+r,n?0:255).toString(16),2)].join("")},lighterColor=function(e,t){return changeColor(e,t,!1)},darkerColor=function(e,t){return changeColor(e,t,!0)};(function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator");t.DataLoader=function(){this.load=function(t,n){var r=e.ajax({type:"GET",url:t,cache:!1,dataType:n,context:this}),i=r.promise();return i}}})(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.util"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.model");t.LoanRepaymentUtil=function(){this.serviceabilityModel=null,this.creditCardExpenseModel=null,this.init=function(e,t){this.serviceabilityModel=t.serviceabilityModel,this.creditCardExpenseModel=t.creditCardExpenseModel};var e=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),t="borrowingPowerResults";this.mapControlsToVO=function(e){var t={hasJointIncome:e.get("hasJointIncome"),primarySalary:parseInt(e.get("primarySalary"),10),primarySalaryTax:e.get("primarySalaryTax"),primarySalaryFrequency:e.getFrequency("primarySalaryFrequency"),secondarySalary:parseInt(e.get("secondarySalary"),10),secondarySalaryTax:e.get("secondarySalaryTax"),secondarySalaryFrequency:e.getFrequency("secondarySalaryFrequency"),otherIncome:parseInt(e.get("otherIncome"),10),otherIncomeTax:e.get("otherIncomeTax"),otherIncomeFrequency:e.getFrequency("otherIncomeFrequency"),dependants:parseInt(e.get("dependants"),10),annualExpenses:parseInt(e.get("annualExpenses"),10),useDefault:e.get("useDefault"),carLoanRepayment:parseInt(e.get("carLoanRepayment"),10),carLoanRepaymentFrequency:e.getFrequency("carLoanRepaymentFrequency"),creditCardRepayment:parseInt(e.get("creditCardRepayment"),10),creditCardRepaymentFrequency:e.getFrequency("creditCardRepaymentFrequency"),otherPayments:parseInt(e.get("otherPayments"),10),otherPaymentsFrequency:e.getFrequency("otherPaymentsFrequency"),interestRate:parseFloat(e.get("interestRate")),term:parseInt(e.get("term"),10)};return t},this.getLoan=function(r){var i=e.periods.month,s=this.calculateMaximumRepaymentAmount(r);s=Math.max(0,s);var o=0;this.serviceabilityModel.getUseBufferFlag()?o=r.interestRate+this.serviceabilityModel.getInterestRateBuffer():o=this.serviceabilityModel.getDefaultRateWithoutBuffer();var u=this.calculateMaximumBorrowingAmount(s,r,o),a=gbst.calculator({pv:u,frequency:i,interestRate:r.interestRate,term:r.term}).loan(),f=a.isInterestOnly(),l=a.pmt({update:!0}),c=u,h=a.totalPmt(),p=h-c;return f&&(p=h,h+=c),a.aggregate({reset:function(){this.loanSummaryResult=new n.LoanSummaryResult,this.chartSummary=this.loanSummaryResult.chartSummary,this.amortizationSummary=this.loanSummaryResult.amortizationSummary},updateResults:function(e,t,n){var r=Math.abs(t.outValues.pv),s=Math.abs(p-t.outValues.totals.interestEarned),o=Math.abs(h-t.outValues.totals.pmt);this.amortizationSummary.push({period:e,principalRemaining:r,interestRemaining:s,totalRemaining:o});if(e%i!=0)return;var u=e/i;this.chartSummary.principalRemaining.push({period:e,x:u,y:r}),this.chartSummary.interestRemaining.push({period:e,x:u,y:s}),this.chartSummary.totalRemaining.push({period:e,x:u,y:o}),this.chartSummary.tooltipData.push({year:u,totalRemaining:o,principalRemaining:r,interestRemaining:s})},finaliseResults:function(e,n,r){this.loanSummaryResult.pmt=l,this.loanSummaryResult.totalInterestPaid=p;var i=r.getStorage(t);i.result=this.loanSummaryResult,this.loanSummaryResult=null}}),a},this.calculateMaximumRepaymentAmount=function(e){var t=this.calculateMonthlyIncome(e),n=this.calculateMonthlyExpenses(e),r=t*this.serviceabilityModel.get("servicableIncomeFactor"),i=r-n;return i},this.calculateMonthlyIncome=function(e){var t=0,n=0,r=0;t=this.calculatePartialMonthlyIncome(e.primarySalary,e.primarySalaryTax,e.primarySalaryFrequency),e.hasJointIncome&&(n=this.calculatePartialMonthlyIncome(e.secondarySalary,e.secondarySalaryTax,e.secondarySalaryFrequency)),r=this.calculatePartialMonthlyIncome(e.otherIncome,e.otherIncomeTax,e.otherIncomeFrequency);var i=t+n+r;return i},this.calculatePartialMonthlyIncome=function(t,n,r){var i=t*r;n=="gross"&&(i=this.calculateIncomeTax(i));var s=i/e.periods.month;return s},this.calculateIncomeTax=function(e){var t=n.incomeTaxManager,r=n.incomeTaxData,i=t.calculateNetIncome(e,r.threshold).netAnnualIncome;return i},this.calculateAnnualDependantsExpenses=function(e,t){var n=this.serviceabilityModel.get("singleBaseExpense"),r=this.serviceabilityModel.get("singleDependentAdditionalExpense");e&&(n=this.serviceabilityModel.get("jointBaseExpense"),r=this.serviceabilityModel.get("jointDependentAdditionalExpense"));var i=n+t*r;return i},this.calculateMonthlyExpenses=function(t){var n=t.annualExpenses,r=n/e.periods.month,i=t.carLoanRepayment,s=t.carLoanRepaymentFrequency,o=i*s/e.periods.month,u=0,a=t.creditCardRepayment;if(this.creditCardExpenseModel.get("useCreditCardLimitExpense")){var f=this.creditCardExpenseModel.get("creditCardLimitExpense");u=a*f}else{var l=t.creditCardRepaymentFrequency;u=a*l/e.periods.month}var c=t.otherPayments,h=t.otherPaymentsFrequency,p=c*h/e.periods.month,d=r+o+u+p;return d},this.calculateMaximumBorrowingAmount=function(e,t,n){var r=this.calculateRemainingPrincipal(t,e,1,n);return r/=1e3,r=Math.floor(r),r*=1e3,r},this.calculateRemainingPrincipal=function(t,n,r,i){var s=e.periods.month,o=i/100;return n*((1-Math.pow(1+o/s,-s*(t.term-r+1)))/(o/s))},this.calculate=function(e){var n=e.calculateLoan(),r=n.getStorage(t),i=r.result;r.result=null,delete r.result;var s=e.squashState();return i.pv=s.pv,i}}}(jQuery),function(e){var t=gbst.module("gbst.common.util"),n=480,r=300;t.ResponsiveUtil={appElement:null,dispatcher:null,fixedWidth:-1,previousWidth:-1,Events:{RESIZE:"responsiveUtil.Resize"},device_size:[{style:"default_layout",range:{min:980,max:Number.POSITIVE_INFINITY}},{style:"portrait_tablets_layout",range:{min:768,max:979}},{style:"phones_to_tablets_layout",range:{min:481,max:767}},{style:"phones_layout",range:{min:0,max:n}}],init:function(t,r,i){this.appElement=t,this.dispatcher=r,this.fixedWidth=i,this.appElement.css("max-width",i),this.fixedWidth<=n&&this.appElement.addClass("phones_layout"),e(window).resize(_.debounce(e.proxy(this.setLayout,this),20)),this.setLayout()},getStyle:function(e){var t=_.find(this.device_size,function(t,n){return t.range.min<=e&&e<=t.range.max});return t.style},setLayout:function(){var e=this.appElement,t=e.parent().width();if(t<=r&&this.previousWidth<=r&&this.previousWidth>0)return;if(t==this.previousWidth)return;this.previousWidth=t;var n=this.getStyle(t);e.removeClass(function(e,t){return(t.match(/\w+_layout/g)||[]).join(" ")}).addClass(n),t<this.fixedWidth&&e.addClass("responsive_layout"),this.dispatcher.trigger(this.Events.RESIZE)}}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.util.stylechange");t.applyStyleChanges=function(){var t=this.prepareContext(),n="borrowing-power-calculator/templates/style",r=HandlebarsTemplates[n](t);e("head").append(r)},t.prepareContext=function(){var e=I18n.t("colors");e.startColor=lighterColor(e.primaryColor,.03),e.hoverColor=e.endColor=darkerColor(e.primaryColor,.1),e.secondaryStartColor=lighterColor(e.secondaryColor,.03),e.secondaryEndColor=darkerColor(e.secondaryColor,.1),e.defaultColor=I18n.t("labels.resultsView.displayType.borderColor"),e.transparentColor="transparent";var t={colors:e};return t},t.changeSelectmenuColor=function(t){var n=I18n.t("colors.textColor"),r=t.find("select").each(function(){e(this).data("selectmenu").list.css("color",n)})}}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.view"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.config");t.AmortizationTableView=Backbone.View.extend({templateId:"borrowing-power-calculator/templates/amortization-table",resultsModel:null,dispatcher:null,tableHeader:null,initialize:function(t){this.resultsModel=t.resultsModel,this.controlsModel=t.controlsModel,this.resultsModel.on("change",e.proxy(this.render,this)),this.tableheader=this.prepareTblHeader()},prepareTblHeader:function(){var e=[];return e=[{sTitle:I18n.t("labels.resultsView.amortizationTable.paymentNumberHeader"),sClass:"payment-period"},{sTitle:I18n.t("labels.resultsView.amortizationTable.principalHeader")},{sTitle:I18n.t("labels.resultsView.amortizationTable.interestHeader")},{sTitle:I18n.t("labels.resultsView.amortizationTable.balanceHeader")}],e},render:function(){var t=this.controlsModel.get("displayType");t==n.displayType.TABLE?this.$el.show():this.$el.hide();var r=this.resultsModel.toJSON();r=this.prepareContext(r);var i=HandlebarsTemplates[this.templateId]();i=e(i),i.find(".amortization-table").dataTable({bSortClasses:!1,bPaginate:!0,bLengthChange:!1,bFilter:!1,bSort:!1,bInfo:!1,bAutoWidth:!0,iDisplayLength:8,aaData:r,aoColumns:this.prepareTblHeader(),bDeferRender:!0}),this.$el.empty().append(i)},prepareContext:function(e){var t=e.amortizationSummary,n=[];return n=this.getAmortizationTableData(t),n},getAmortizationTableData:function(e){var t=[];return _.each(e,function(e,n){var r=[n,accounting.formatMoney(e.principalRemaining,"Rs ",0,",","."),accounting.formatMoney(e.interestRemaining,"Rs ",0,",","."),accounting.formatMoney(e.totalRemaining,"Rs ",0,",",".")];t[n]=r}),t}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),r=gbst.module("gbst.loan.app.borrowingpowercalculator.model"),i=gbst.module("gbst.loan.app.borrowingpowercalculator.view");i.BorrowingPowerControlsView=Backbone.View.extend({dispatcher:null,controlsModel:null,calcUtil:null,controlsDeclaration:null,controlsList:null,controlAnnualExpenses:null,dependantsRadioList:[],creditCardExpenseModel:null,events:{"click h2":"headerClick_handler"},initialize:function(t){this.dispatcher=e(t.dispatcher),this.controlsModel=t.controlsModel,this.creditCardExpenseModel=t.creditCardExpenseModel,this.calcUtil=t.calcUtil,this.controlsDeclaration=r.ControlsDeclaration(),this.controlsModel.on("change:hasJointIncome",e.proxy(this.hasJointIncome_handler,this)),this.controlsModel.on("change:annualExpenses",e.proxy(this.annualExpenses_change,this)),this.controlsModel.on("change:useDefault",e.proxy(this.useDefault_handler,this)),this.controlsList=[]},headerClick_handler:function(t){var n=e(t.currentTarget),r=n.next(".expandable");r.slideToggle()},getControlByName:function(e){var t=_.find(this.controlsList,function(t){return t.controlConfig.name==e});return t},getAnnualExpensesControl:function(){return this.controlAnnualExpenses||(this.controlAnnualExpenses=this.getControlByName("annualExpenses")),this.controlAnnualExpenses},hasJointIncome_handler:function(e){var t=e.get("hasJointIncome"),n=this.$el.find(".secondary-salary-panel");t?n.slideDown("fast"):n.slideUp("fast")},annualExpenses_change:function(e){var t=this.getAnnualExpensesControl();t.render()},useDefault_handler:function(e){var t=e.get("useDefault"),n=this.getAnnualExpensesControl();n.disable(t),t?n.$el.addClass("rangeInputDisable"):n.$el.removeClass("rangeInputDisable")},render:function(){var e=0,t=0,n=this.controlsList;if(!this.controlsCreated){this.$el.empty();var i=r.ControlsDeclaration();for(var e in i){var s=i[e],o=this.$el.find("."+s.id);this.createPanel(s,o)}this.controlsCreated=!0}t=n.length;for(e=0;e<t;e++)n[e].render();return this.useDefault_handler(this.controlsModel),this.hasJointIncome_handler(this.controlsModel),this.annualExpenses_change(this.controlsModel),this.changeToCreditCardLimitExpenses(),this.changeUseDefaultCheckbox(),this},changeToCreditCardLimitExpenses:function(){if(this.creditCardExpenseModel.get("useCreditCardLimitExpense")){var e=I18n.t("defaults.controls.creditCardExpense.creditCardLimitExpenseLabel");this.$el.find("div.creditCardRepayment > .slider-label").text(e),this.$el.find("div.creditCardRepaymentFrequency").children().hide()}},changeUseDefaultCheckbox:function(){var e=I18n.t("labels.yourExpensesControlsView").showDefaultExpenseCheckbox;e||this.$el.find("div.useDefault").children().hide()},createPanel:function(e,t){var n=HandlebarsTemplates[e.id]();this.$el.append(n),this.createControls(this.$el,e.controls,this.controlsModel)},createControls:function(e,t,n){var r=0,i=null,s=t.length,o=null,u=null;for(r=0;r<s;r++)o=t[r],i=o.elementSelector||"."+o.name,u=new o.view({el:e.find(i),dispatcher:this.dispatcher,controlConfig:o,model:n}),this.controlsList.push(u)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),r=gbst.module("gbst.loan.app.borrowingpowercalculator.view"),i=gbst.module("gbst.loan.app.borrowingpowercalculator.model"),s=gbst.module("gbst.loan.app.borrowingpowercalculator.util.stylechange"),o=gbst.module("gbst.common.util");t.BorrowingPowerCalculatorView=Backbone.View.extend({appTemplateId:"borrowing-power-calculator/templates/app-template",infoOverlayId:"borrowing-power-calculator/templates/information-overlay-tmpl",infoOverlayElement:null,dispatcher:null,viewInitialised:!1,controlsView:null,resultsView:null,chartView:null,controlsModel:null,creditCardExpenseModel:null,calcUtil:null,viewContext:null,infoContext:null,chartElement:null,tableElement:null,displayTypeview:null,amortizationTableView:null,displayTypeFieldset:null,events:{"click .info-icon":"infoClickHandler","click .print-icon":"print"},initialize:function(n){this.dispatcher=n.dispatcher,this.controlsModel=n.controlsModel,this.resultsModel=n.resultsModel,this.creditCardExpenseModel=n.creditCardExpenseModel,this.controlsModel.on("change:displayType",e.proxy(this.displayTypeHandler,this)),this.calcUtil=n.calcUtil,this.dispatcher.bind(t.Events.CHART_LOADED,e.proxy(this.registerCalculation,this)),this.dispatcher.bind(o.ResponsiveUtil.Events.RESIZE,e.proxy(this.resizeOverlay,this))},registerCalculation:function(){var e=this;_.defer(function(){e.dispatcher.trigger(t.Events.CALCULATE,[e.controlsModel,e.resultsModel])})},render:function(){s.applyStyleChanges();var e=this.$el,t=this.showDisplayType=I18n.t("labels.resultsView").showDisplayType;if(!this.viewInitialised){this.viewInitialised=!0,this.viewContext||(this.viewContext=this.prepareContext());var n=HandlebarsTemplates[this.appTemplateId](this.viewContext);e.empty().append(n),this.charElement=this.$el.find(".chart-wrapper"),this.tableElement=this.$el.find(".amortization-table-wrapper"),this.controlsView=new r.BorrowingPowerControlsView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,creditCardExpenseModel:this.creditCardExpenseModel,el:e.find(".inputs-wrapper"),calcUtil:this.calcUtil}),this.resultsView=new r.ResultsView({dispatcher:this.dispatcher,resultsModel:this.resultsModel,el:e.find(".outputs-wrapper")}),this.chartView=new r.ChartView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,el:e.find(".chart-wrapper")});if(t){var o=i.DisplayTypeDeclaration(),u=o.elementSelector||"."+o.name;this.displayTypeView=new o.view({el:this.$el.find(u),dispatcher:this.dispatcher,controlConfig:o,model:this.controlsModel}),this.amortizationTableView=new r.AmortizationTableView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,el:e.find(".amortization-table-wrapper")})}}return this.controlsView.render(),this.resultsView.render(),e.find(".gbst-loan-repayment").fadeIn(),this.chartView.render(),t&&(this.displayTypeView.render(),this.displayTypeFieldset=this.displayTypeView.$el.find("fieldset")),s.changeSelectmenuColor(e),this},prepareContext:function(){var e={};return e.calculatorTitle=I18n.t("labels.borrowingPowerCalculator.calculatorTitle"),e.resultsHeader=I18n.t("labels.resultsView.resultsHeader"),e.disclaimer=I18n.t("labels.borrowingPowerCalculator.disclaimer"),e},prepareInfoContext:function(){var e={};e.title=I18n.t("labels.infoBox.title");var t=_.extend({},I18n.t("defaults.controls.serviceability"));for(var n=0;n<5;n++)t["singleExpense"+n]=I18n.toCurrency(this.calcUtil.calculateAnnualDependantsExpenses(!1,n),{precision:0}),t["jointExpense"+n]=I18n.toCurrency(this.calcUtil.calculateAnnualDependantsExpenses(!0,n),{precision:0});return t.additionalExpense=I18n.toCurrency(t.singleDependentAdditionalExpense,{precision:0}),t.servicableIncomeFactor=I18n.toPercentage(t.servicableIncomeFactor*100,{precision:0}),t.interestRateBuffer=I18n.toPercentage(t.interestRateBuffer*100,{precision:1}),e.content=I18n.t("labels.infoBox.content",t),e},infoClickHandler:function(t){var r=this.infoOverlayElement;if(r==null){this.infoContext||(this.infoContext=this.prepareInfoContext());var i=HandlebarsTemplates[this.infoOverlayId](this.infoContext);i=e(i),this.$el.append(i),r=this.infoOverlayElement=i.overlay(n.infoOverlayConfig)}return r.overlay().load(),this.resizeOverlay(),r.css({top:0,left:0}),!1},resizeOverlay:function(){if(!this.infoOverlayElement)return;if(this.infoOverlayElement.is(":hidden"))return;var e=parseInt(this.$el.css("height"),10)-14;this.infoOverlayElement.css("height",e);var t=parseInt(this.$el.css("width"),10)-14;this.infoOverlayElement.css("width",t);var n=this.infoOverlayElement.find(".content");n.css("height",e-120)},print:function(){window.print()},displayTypeHandler:function(e){var r=e.get("displayType");r==n.displayType.GRAPH?(this.charElement.show(),this.dispatcher.trigger(t.Events.REFRESH_GRAPH,[r]),this.tableElement.hide()):(this.charElement.hide(),this.tableElement.show())}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.config.chart"),r=gbst.module("gbst.loan.app.borrowingpowercalculator.view");r.ChartTooltipView=Backbone.View.extend({templateId:"borrowing-power-calculator/templates/chart-tooltip",wrapperClass:"chart-tooltip-wrapper",dispatcher:null,viewInitialised:!1,initialize:function(n){this.dispatcher=n.dispatcher,this.hide(),this.dispatcher.bind(t.Events.SHOW_CHART_TOOLTIP,e.proxy(this.showTooltip_handler,this)),this.dispatcher.bind(t.Events.HIDE_CHART_TOOLTIP,e.proxy(this.hideTooltip_handler,this))},render:function(){return this.$el.addClass(this.wrapperClass),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},showTooltip_handler:function(){},hideTooltip_handler:function(){},showData:function(e,t){var n=t[e],r=this.getTemplate(n);this.$el.empty().append(r)},getTemplate:function(e){var t=HandlebarsTemplates[this.templateId](e);return t}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.config.chart"),r=gbst.module("gbst.loan.app.borrowingpowercalculator"),i=gbst.module("gbst.loan.app.borrowingpowercalculator.view"),s=gbst.module("gbst.common.util");i.ChartView=Backbone.View.extend({dispatcher:null,resultsModel:null,controlsModel:null,templateId:"borrowing-power-calculator/templates/loan-chart",chartClass:"loan-chart",chartInstance:null,chartElement:null,tooltipView:null,hasPlotLine:!1,oldMouseOverIndex:null,tooltipData:null,initialize:function(t){this.dispatcher=e(t.dispatcher),this.createChartElements(this.$el),this.hideTooltip_proxy=e.proxy(this.hideTooltip,this),this.resultsModel=t.resultsModel,this.controlsModel=t.controlsModel,this.resultsModel.on("change",e.proxy(this.refreshGraph,this)),this.dispatcher.bind(r.Events.REFRESH_GRAPH,e.proxy(this.refreshGraph,this)),this.dispatcher.bind(s.ResponsiveUtil.Events.RESIZE,e.proxy(this.resizeGraph,this))},renderGraph:function(){var e=this.resultsModel.get("chartSummary"),t=0,r=this.chartInstance,i=n.getChartSeries(),s=i.length,o=null,u=null,a=null;for(t=0;t<s;t++){u=i[t],o=r.get(u.id),a=e[u.id];if(!o)throw new Error("Could not find chart series ID='"+u.id+"'");o.setData(a,!1)}this.tooltipData=e.tooltipData,r.redraw()},render:function(){if(!this.viewInitialised){var e=this.controlsModel.get("displayType");e==t.displayType.GRAPH&&this.$el.show();var i=this,s=function(){i.dispatcher.trigger(r.Events.CHART_LOADED)},o=n.getChartConfig(this.chartElement[0],s);this.chartInstance=new Highcharts.Chart(o),this.initChartEvents(this.$el),this.viewInitialised=!0,e!=t.displayType.GRAPH&&this.$el.hide()}return this.tooltipView.render(),this},createChartElements:function(t){var n=gbst.util.getNewId(),r=HandlebarsTemplates[this.templateId]();r=e(r),r.attr("id",n),this.chartElement=r;var s=new i.ChartTooltipView({dispatcher:this.dispatcher});this.tooltipView=s,t.append(r,s.$el)},initChartEvents:function(n){var r=e.proxy(this.startTooltipTimer,this),i=e.proxy(this.chartTouchMouseMoveHandler,this);t.isTouchEnabled?(n.bind("touchstart touchmove",i),e(document).bind("touchstart",function(){r()})):(n.bind("mousemove",i),n.bind("mouseout",r))},chartTouchMouseMoveHandler:function(n){var r=this.chartInstance.series[0],i=r.xAxis,s=r.data,o=0,u=0,a=e(this.chartInstance.container).offset();if(!a)return;var f=n.originalEvent?n.originalEvent:{pageX:0,pageY:0};t.isTouchEnabled?(o=n.originalEvent.touches[0].pageX,u=n.originalEvent.touches[0].pageY):(o=n.pageX?n.pageX:f.pageX,u=n.pageY?n.pageY:f.pageY);var l=o-this.chartInstance.plotLeft-a.left,c=u-this.chartInstance.plotTop-a.top,h=Math.round(i.translate(l,!0));if(h>=0&&h<s.length&&s.length>1){this.tooltipView.show(),this.oldMouseOverIndex!=h&&(this.oldMouseOverIndex=h,this.tooltipView.showData(h,this.tooltipData),this.tooltipShown=!0,this.showPlotLine(i,h));var p=o-a.left,d=u-a.top;this.positionTooltip(n,this.tooltipView,p,d),this.clearTooltipTimer()}else this.startTooltipTimer()},showPlotLine:function(e,t){this.hidePlotLine(e),e.addPlotLine({id:"mousePos",color:n.tooltip.indicatorColor,value:t,width:2,zIndex:15}),this.hasPlotLine=!0},hidePlotLine:function(e){if(!e){var t=this.chartInstance.series[0];e=t.xAxis}this.hasPlotLine&&(e.removePlotLine("mousePos"),this.hasPlotLine=!1)},positionTooltip:function(e,t,r,i){var s=t.$el,o=n.tooltip,u=e.type.indexOf("touch")>=0;u&&e.stopPropagation();var a=u?o.touchOffsetX:o.mouseOffsetX,f=u?o.touchOffsetY:o.mouseOffsetY,l=r+a,c=i+f,h=s.parent(),p=h.width(),d=h.height(),v=s.width(),m=s.height();v+l>p?(l=r-v-a,this.tooltipStyle==null&&(s.addClass("right"),this.tooltipStyle="right")):this.tooltipStyle!=null&&(s.removeClass("right"),this.tooltipStyle=null),l=Math.min(Math.max(-v,l),p-v),c=Math.min(Math.max(0,c),d-m),s.css({left:l,top:c})},startTooltipTimer:function(){this.clearTooltipTimer(),this.seriesMouseOutTimeoutId=setTimeout(this.hideTooltip_proxy,250)},clearTooltipTimer:function(){this.seriesMouseOutTimeoutId!=null&&(clearTimeout(this.seriesMouseOutTimeoutId),this.seriesMouseOutTimeoutId=null)},hideTooltip:function(){this.clearTooltipTimer(),this.tooltipView.hide(),this.hidePlotLine()},hideTooltip_proxy:null,refreshGraph:function(){var e=this.controlsModel.get("displayType");e==t.displayType.GRAPH&&(this.renderGraph(),this.resizeGraph())},resizeGraph:function(){var e=this.controlsModel.get("displayType");if(e!=t.displayType.GRAPH)return;var n=this.chartInstance,r=this.chartElement.width(),i=this.chartElement.height();n.setSize(r,i,!1)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator"),n=gbst.module("gbst.loan.app.borrowingpowercalculator.view");n.ResultsView=Backbone.View.extend({templateId:"borrowing-power-calculator/templates/outputs-wrapper",resultsModel:null,dispatcher:null,initialize:function(t){this.resultsModel=t.resultsModel,this.dispatcher=e(t.dispatcher),this.resultsModel.on("change",e.proxy(this.renderResults,this))},prepareContext:function(){var e=this.resultsModel.toJSON(),t=I18n.t("defaults.controls.frequency"),n=this.resultsModel.get("frequency"),r=_.find(t,function(e,t){return e.value==n}),i=null;return r&&(i=I18n.t("labels.resultsView.regularRepaymentLabel",{frequencyLabel:r.label})),e.frequencyLabel=i,e},render:function(){return this.renderResults(this.results),this},renderResults:function(e){var e=this.prepareContext(),t=HandlebarsTemplates[this.templateId](e);this.$el.empty().append(t)}})}(jQuery),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.control");t.APIController=function(){this.inputs=null,this.results=null,this.init=function(e,t,n){this.inputs=e,this.results=t,n&&this.restoreCalc(n)},this.getValues=function(){var e={inputs:this.inputs.toJSON(),results:this.results.toJSON()};return e},this.restoreCalc=function(e){this.inputs.set(e,{silent:!0})}}}($),function(e){var t=gbst.module("gbst.loan.app.borrowingpowercalculator.config");I18n.defaultLocale="en",I18n.fallbacks=!0,t.incomeTaxURL="assets/borrowing-power-calculator/data/2011-2012.html",t.style={styleSelectMenu:!0},t.infoOverlayConfig={fixed:!1,top:0,left:0},t.periods={annual:1,month:12,fortnight:26,week:52},t.displayType={GRAPH:"GRAPH",TABLE:"TABLE"},t.convertFn={numberConverter:function(e){var t=I18n.t("number.format.separator"),n=gbst.util.NumberUtil.parseNumber(e,t);return n},moneyConverter_back:function(e,t,n){var r=I18n.toCurrency(e,{precision:0});return r},listConverter:function(e){return e},listConverter_back:function(e){return[e]},interestConverter:function(e){var t=I18n.t("number.format.separator"),n=gbst.util.NumberUtil.parseNumber(e,t);return n},interestConverter_back:function(e){var t=I18n.toPercentage(e,{precision:2});return t},numberParser:function(e){var t=parseInt(e,10);return t},numberParser_back:function(e){return e.toString(10)}},t.isTouchEnabled=Modernizr.touch}(jQuery),function(e){var t=gbst.namespace("gbst.data"),n=gbst.module("gbst.loan.app.borrowingpowercalculator"),r=gbst.module("gbst.loan.app.borrowingpowercalculator.config"),i=gbst.module("gbst.loan.app.borrowingpowercalculator.model"),s=gbst.module("gbst.loan.app.borrowingpowercalculator.util"),o=gbst.module("gbst.loan.app.borrowingpowercalculator.control"),u=gbst.module("gbst.common.util");n.Events={CALCULATE:"borrowingpowercalculator.calculate",SHOW_CHART_TOOLTIP:"borrowingpowercalculator.showChartTooltip",HIDE_CHART_TOOLTIP:"borrowingpowercalculator.hideChartTooltip",CONTROL_CHANGE:"borrowingpowercalculator.control.change",REFRESH_GRAPH:"borrowingpowercalculator.refreshGraph",CHART_LOADED:"borrowingpowercalculator.chartLoaded"},n.LoanCalculatorApp=function(r){this.dispatcher=e({}),this.parentEl=r,this.mainView=null,this.controlsModel=null,this.storageAvailable=!1,this.loanRepaymentUtil=null,this.serviceabilityModel=null,this.creditCardExpenseModel=null,this.borrowingPowerController=null,this.init=function(n){e.support.cors=!0;if(n)this.options=n;else{var r=e.url().param("calc_settings");r&&(r=decodeURI(r),this.options=JSON.parse(r))}i.incomeTaxManager=new gbst.incometax.IncomeTaxManager,i.incomeTaxData=t.incomeTax;var s=614;u.ResponsiveUtil.init(this.parentEl,this.dispatcher,s),this.setupMainView()},this.loadDataError_proxy=function(e,t,n){console.log(e,t,n)},this.processIncomeTax_proxy=function(e){i.incomeTaxData=i.incomeTaxManager.parseRawData(e)},this.setupMainView=function(){this.storageAvailable=window.localStorage!=null,this.initResolver(),this.mainView=new n.BorrowingPowerCalculatorView({dispatcher:this.dispatcher,controlsModel:this.controlsModel,resultsModel:this.resultsModel,calcUtil:this.loanRepaymentUtil,creditCardExpenseModel:this.creditCardExpenseModel}),this.parentEl.append(this.mainView.$el),this.mainView.render()},this.initResolver=function(){this.controlsModel=new i.ControlValues(I18n.t("defaults.values")),this.resultsModel=new i.ResultsModel,this.loanRepaymentUtil=new s.LoanRepaymentUtil,this.serviceabilityModel=new i.ServiceabilityModel(I18n.t("defaults.controls.serviceability")),this.creditCardExpenseModel=new i.CreditCardExpenseModel(I18n.t("defaults.controls.creditCardExpense")),this.loanRepaymentUtil.init(this.dispatcher,this),this.borrowingPowerController=new o.BorrowingPowerController,this.borrowingPowerController.init(this.dispatcher,this),this.apiController=new o.APIController,this.apiController.init(this.controlsModel,this.resultsModel,this.options)},this.restorePreviousValues=function(){if(this.storageAvailable){var e=this;this.controlsModel.fetch({success:function(){e.mainView.render(),e.dispatcher.trigger(n.Events.CALCULATE,[e.controlsModel,e.resultsModel])}})}},this.getCurrentValues=function(){return this.apiController.getValues()}}}(jQuery);